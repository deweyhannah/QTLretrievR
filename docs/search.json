[{"path":"https://deweyhannah.github.io/QTLretrievR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":null,"text":"Copyright (c) 2024 QTLretrievR authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Introduction","title":null,"text":"vignette demonstrate using QTLretrievR Attie DO500 dataset available QTLviewer published Nature Communications. using liver lipids dataset mice genotyped using Neogen GigaMUGA 143k SNP array. First set environment loading QTLretrievR tidyverse. Next load data. cleanup objects need QTLretrievR preserved environment. markers associated genoprobs GigaMUGA grid map, .Rdata file need retain genoprobs object, since GigaMUGA gridfile available QTLretrievR. liver_lipids object, want retain: - annot.samples - $data$norm sample annotations, normalized lipid counts.","code":"## read in data load(\"../../_data/attie.core.GRCm39.v1.Rdata\") liver_lipids <- readRDS(url(\"https://churchilllab.jax.org/qtlviewer/attie/DO500HFD/dl?fileName=LiverLipids_Phenotypes_V11.rds\"))  ## save annotations (metadata) and normalized counts sample_meta <- as.data.frame(liver_lipids$annot.samples) sample_meta <- sample_meta |>    dplyr::select(ID = MouseID, sex = Sex)  norm_counts <- liver_lipids$data$norm  ## clean up rm(ensembl_version, K, liver_lipids, map, markers)"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Running QTLretrievR","title":null,"text":"Now data set R environment cleaned , ’re ready start running QTLretrievR. already genoprobs correct format (founder allele probabilities). see general overview impute genotype probabilities GigaMUGA SNP-level calls, please see overview vignette. demo show running peak calling, effects calculation, mediation analysis steps separately. wish run three steps together, can use runQTL function. run option, keep mind effects mediation steps require input suggestive LOD score threshold, filter identifying suggestive significant LOD scores. following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. may notice 16 cores found available Linux system, 8 registered used peak calling. < 1000 phenotypes, found using 8 cores appreciably decrease amount time used peak calling. now briefly look map_peaks object looks like. QTLretrievR returns everything list format separating everything based tissue. Since using liver lipids, tissue liver. using lipid measurements multiple tissues, lists length > 1 named tissue. maps_list peaks_list list element map_peaks$maps_list object list objects different tissues. maps_list preserves following future use either plotting functions, want re-run specific tissue phenotype. qtlprobs: Genotype probabilities (founder allele probabilities) tissue (separated chromosome within tissues, samples x allele x marker) covar_list: Covariate dataframes tissue. Covariates may include sex, diet, age, batch number, etc. expr_list: Copy normalized expression matrices tissue (phenotype x samples) exprZ_list: Copy rankZ transformed expression matrices tissue (samples x phenotype) kinship_loco: Sample kinship matrix tissue, calculated sample genoprobs using leave one chromosome (loco) method (separated chromosome within tissues, samples x samples) gmap: Genetic map markers (centiMorgans cM, separated chromosome) map_dat2: Dataframe markers, genetic physical positions, order markers appear genome. pmap: Physical map markers (basepairs bp, separated chromosome) tissue_samp: Copy sample metadata separated tissue like genetic map distances (cM) rather physical map distances (bp) QTL peaks, can use interp_cM, can use phys = F call mapQTL runQTL. default QTLretrievR return LOD scores < 5; like change threshold, can use thrA thrX autosomes X chromosome, respectively. can also visualize peaks look like overall.  visualize allelic effects occurring specific peak.  calculated peaks, good idea determine significant suggestive LOD thresholds. help us determine phenotypes/QTLs investigate . performing eQTL mapping, can also influence peaks included characterization distal hotspot. , use function LOD_thld; choose 5 lipid phenotypes run 500 permutations , take median values determine significant (alpha = 0.05) suggestive (alpha = 0.4) LOD thresholds. default function use 10 phenotypes run 1000 permutations . number appropriate eQTL analyses many thousands gene expression phenotypes, unnecessary ~1500 liver lipids. return permutations object well significant suggestive LODs named list. significant suggestive LOD thresholds 7.697 6.297 respectively, use values mediation analysis haplotype effect identification.","code":"## Downsample to 200 liver lipids phenotypes <- sample(colnames(norm_counts), 200, replace = FALSE)  ## Perform QTL Mapping start_time <- Sys.time()  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"liver_lipids_GM_peaks_sub.rds\",                     map_out       = \"liver_lipids_GM_map_sub.rds\",                     genoprobs     = list(\"liver\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"liver\" = t(norm_counts[,phenotypes])),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"ro\") checking probabilities min_cores not provided using 4 cores as minimum liver gmap complete pmap complete expression loaded Working with 369 samples and 200 genes in liver. rankZ normalized covariates calculated calculating peaks SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). Does that look right? If not please                  set total_cores parameter to the number of available cores. end_time <- Sys.time()  end_time - start_time Time difference of 26.05502 mins names(map_peaks$maps_list) [1] \"qtlprobs\"     \"covar_list\"   \"expr_list\"    \"exprZ_list\"   \"kinship_loco\" [6] \"gmap\"         \"map_dat2\"     \"pmap\"         \"tissue_samp\" str(map_peaks$maps_list$qtlprobs$liver[[1]]) num [1:483, 1:8, 1:9449] 1.26e-03 8.19e-03 8.20e-03 8.20e-03 8.47e-08 ...  - attr(*, \"dimnames\")=List of 3   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ...   ..$ : chr [1:9449] \"UNC6\" \"UNCHS000001\" \"JAX00000010\" \"JAX00000010r\" ... str(map_peaks$maps_list$kinship_loco$liver[[1]]) num [1:483, 1:483] 0.553 0.13 0.149 0.13 0.156 ...  - attr(*, \"n_pos\")= int 114433  - attr(*, \"dimnames\")=List of 2   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ... str(map_peaks$peaks_list) List of 1  $ liver:'data.frame':  906 obs. of  6 variables:   ..$ phenotype: chr [1:906] \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" ...   ..$ peak_chr : Factor w/ 20 levels \"1\",\"2\",\"3\",\"4\",..: 5 11 12 15 20 3 5 8 10 11 ...   ..$ peak_bp  : num [1:906] 7.68e+07 6.19e+06 1.19e+07 6.79e+07 1.59e+08 ...   ..$ lod      : num [1:906] 5.85 5.19 5.02 6.86 5.21 ...   ..$ ci_lo    : num [1:906] 72517079 3070782 3082700 65182973 12309718 ...   ..$ ci_hi    : num [1:906] 9.73e+07 1.16e+08 8.70e+07 7.03e+07 1.63e+08 ... summary(map_peaks$peaks_list$liver) phenotype            peak_chr      peak_bp               lod          Length:906         15     : 67   Min.   :  3309356   Min.   : 5.001    Class :character   6      : 59   1st Qu.: 43624520   1st Qu.: 5.239    Mode  :character   18     : 59   Median : 76768036   Median : 5.517                       11     : 57   Mean   : 77905714   Mean   : 5.872                       5      : 56   3rd Qu.:111810346   3rd Qu.: 5.981                       X      : 56   Max.   :193382813   Max.   :28.765                       (Other):552                                             ci_lo               ci_hi            Min.   :  3050998   Min.   :  6461844    1st Qu.:  9575738   1st Qu.: 83157539    Median : 26815537   Median :114629680    Mean   : 38118599   Mean   :108771467    3rd Qu.: 57496244   3rd Qu.:140278885    Max.   :189248419   Max.   :195014334 ## Use a phenotype that will be used later in the vignette peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           psave   = F) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). NULL ## Chromosome 15 based on the peak location above ## Plot effects peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           chrom = 15,            effects = T,           psave   = F) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). calculating effects NULL start_time <- Sys.time()  thlds <- LOD_thld(mapping = map_peaks$maps_list,                   tissue  = \"liver\",                    n.gene  = 5,                    n.perm  = 500) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Using 5 phenotypes: UNK_9.634_726.93475_minus  UNK_11.811_1117.70117_minus  TG_18.1_18.1_20.3_1_17.719_926.80585_plus  TG_18.0_18.0_20.4_19.256_933.77148_plus  UNK_1.953_482.35989_plus Running 500 permutations on 5 genes in 1 batches. end_time <- Sys.time()  end_time - start_time Time difference of 4.259334 hours str(thlds) List of 2  $ perms_df: 'scan1perm' num [1:500, 1:5] 6.29 6.49 5.47 6.67 5.3 ...   ..- attr(*, \"dimnames\")=List of 2   .. ..$ : NULL   .. ..$ : chr [1:5] \"UNK_9.634_726.93475_minus\" \"UNK_11.811_1117.70117_minus\" \"TG_18.1_18.1_20.3_1_17.719_926.80585_plus\" \"TG_18.0_18.0_20.4_19.256_933.77148_plus\" ...  $ thlds   :List of 2   ..$ sigLOD : num 7.7   ..$ suggLOD: num 6.3"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Mapping & Peak Calling","title":null,"text":"following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. may notice 16 cores found available Linux system, 8 registered used peak calling. < 1000 phenotypes, found using 8 cores appreciably decrease amount time used peak calling. now briefly look map_peaks object looks like. QTLretrievR returns everything list format separating everything based tissue. Since using liver lipids, tissue liver. using lipid measurements multiple tissues, lists length > 1 named tissue. maps_list peaks_list list element map_peaks$maps_list object list objects different tissues. maps_list preserves following future use either plotting functions, want re-run specific tissue phenotype. qtlprobs: Genotype probabilities (founder allele probabilities) tissue (separated chromosome within tissues, samples x allele x marker) covar_list: Covariate dataframes tissue. Covariates may include sex, diet, age, batch number, etc. expr_list: Copy normalized expression matrices tissue (phenotype x samples) exprZ_list: Copy rankZ transformed expression matrices tissue (samples x phenotype) kinship_loco: Sample kinship matrix tissue, calculated sample genoprobs using leave one chromosome (loco) method (separated chromosome within tissues, samples x samples) gmap: Genetic map markers (centiMorgans cM, separated chromosome) map_dat2: Dataframe markers, genetic physical positions, order markers appear genome. pmap: Physical map markers (basepairs bp, separated chromosome) tissue_samp: Copy sample metadata separated tissue like genetic map distances (cM) rather physical map distances (bp) QTL peaks, can use interp_cM, can use phys = F call mapQTL runQTL. default QTLretrievR return LOD scores < 5; like change threshold, can use thrA thrX autosomes X chromosome, respectively. can also visualize peaks look like overall.  visualize allelic effects occurring specific peak.","code":"## Downsample to 200 liver lipids phenotypes <- sample(colnames(norm_counts), 200, replace = FALSE)  ## Perform QTL Mapping start_time <- Sys.time()  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"liver_lipids_GM_peaks_sub.rds\",                     map_out       = \"liver_lipids_GM_map_sub.rds\",                     genoprobs     = list(\"liver\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"liver\" = t(norm_counts[,phenotypes])),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"ro\") checking probabilities min_cores not provided using 4 cores as minimum liver gmap complete pmap complete expression loaded Working with 369 samples and 200 genes in liver. rankZ normalized covariates calculated calculating peaks SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). Does that look right? If not please                  set total_cores parameter to the number of available cores. end_time <- Sys.time()  end_time - start_time Time difference of 26.05502 mins names(map_peaks$maps_list) [1] \"qtlprobs\"     \"covar_list\"   \"expr_list\"    \"exprZ_list\"   \"kinship_loco\" [6] \"gmap\"         \"map_dat2\"     \"pmap\"         \"tissue_samp\" str(map_peaks$maps_list$qtlprobs$liver[[1]]) num [1:483, 1:8, 1:9449] 1.26e-03 8.19e-03 8.20e-03 8.20e-03 8.47e-08 ...  - attr(*, \"dimnames\")=List of 3   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ...   ..$ : chr [1:9449] \"UNC6\" \"UNCHS000001\" \"JAX00000010\" \"JAX00000010r\" ... str(map_peaks$maps_list$kinship_loco$liver[[1]]) num [1:483, 1:483] 0.553 0.13 0.149 0.13 0.156 ...  - attr(*, \"n_pos\")= int 114433  - attr(*, \"dimnames\")=List of 2   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ... str(map_peaks$peaks_list) List of 1  $ liver:'data.frame':  906 obs. of  6 variables:   ..$ phenotype: chr [1:906] \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" ...   ..$ peak_chr : Factor w/ 20 levels \"1\",\"2\",\"3\",\"4\",..: 5 11 12 15 20 3 5 8 10 11 ...   ..$ peak_bp  : num [1:906] 7.68e+07 6.19e+06 1.19e+07 6.79e+07 1.59e+08 ...   ..$ lod      : num [1:906] 5.85 5.19 5.02 6.86 5.21 ...   ..$ ci_lo    : num [1:906] 72517079 3070782 3082700 65182973 12309718 ...   ..$ ci_hi    : num [1:906] 9.73e+07 1.16e+08 8.70e+07 7.03e+07 1.63e+08 ... summary(map_peaks$peaks_list$liver) phenotype            peak_chr      peak_bp               lod          Length:906         15     : 67   Min.   :  3309356   Min.   : 5.001    Class :character   6      : 59   1st Qu.: 43624520   1st Qu.: 5.239    Mode  :character   18     : 59   Median : 76768036   Median : 5.517                       11     : 57   Mean   : 77905714   Mean   : 5.872                       5      : 56   3rd Qu.:111810346   3rd Qu.: 5.981                       X      : 56   Max.   :193382813   Max.   :28.765                       (Other):552                                             ci_lo               ci_hi            Min.   :  3050998   Min.   :  6461844    1st Qu.:  9575738   1st Qu.: 83157539    Median : 26815537   Median :114629680    Mean   : 38118599   Mean   :108771467    3rd Qu.: 57496244   3rd Qu.:140278885    Max.   :189248419   Max.   :195014334 ## Use a phenotype that will be used later in the vignette peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           psave   = F) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). NULL ## Chromosome 15 based on the peak location above ## Plot effects peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           chrom = 15,            effects = T,           psave   = F) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). calculating effects NULL"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"LOD Thresholding","title":null,"text":"calculated peaks, good idea determine significant suggestive LOD thresholds. help us determine phenotypes/QTLs investigate . performing eQTL mapping, can also influence peaks included characterization distal hotspot. , use function LOD_thld; choose 5 lipid phenotypes run 500 permutations , take median values determine significant (alpha = 0.05) suggestive (alpha = 0.4) LOD thresholds. default function use 10 phenotypes run 1000 permutations . number appropriate eQTL analyses many thousands gene expression phenotypes, unnecessary ~1500 liver lipids. return permutations object well significant suggestive LODs named list. significant suggestive LOD thresholds 7.697 6.297 respectively, use values mediation analysis haplotype effect identification.","code":"start_time <- Sys.time()  thlds <- LOD_thld(mapping = map_peaks$maps_list,                   tissue  = \"liver\",                    n.gene  = 5,                    n.perm  = 500) SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Using 5 phenotypes: UNK_9.634_726.93475_minus  UNK_11.811_1117.70117_minus  TG_18.1_18.1_20.3_1_17.719_926.80585_plus  TG_18.0_18.0_20.4_19.256_933.77148_plus  UNK_1.953_482.35989_plus Running 500 permutations on 5 genes in 1 batches. end_time <- Sys.time()  end_time - start_time Time difference of 4.259334 hours str(thlds) List of 2  $ perms_df: 'scan1perm' num [1:500, 1:5] 6.29 6.49 5.47 6.67 5.3 ...   ..- attr(*, \"dimnames\")=List of 2   .. ..$ : NULL   .. ..$ : chr [1:5] \"UNK_9.634_726.93475_minus\" \"UNK_11.811_1117.70117_minus\" \"TG_18.1_18.1_20.3_1_17.719_926.80585_plus\" \"TG_18.0_18.0_20.4_19.256_933.77148_plus\" ...  $ thlds   :List of 2   ..$ sigLOD : num 7.7   ..$ suggLOD: num 6.3"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Next Steps","title":null,"text":"number next steps can taken follow peak identification thresholding. include ascertaining founder strain alleles responsible driving observed QTL effect, performing mediation analysis identify potential causal intermediates responsible conferring QTL.analyses described . can determine founder strain coefficients different QTL peaks. Now, going look peaks mapping across genome identify location multiple phenotypes associated . results 3 phenotypes map position chromosome 15, continue use example rest vignette. unfamiliar Diversity Outbred () mouse population, outbred population derived 8 founder inbred strains represented -H. letter corresponds different founder, order : AJ, B6, 129, NOD, NZO, CAST, PWK, WSB. Chromosome 15 lipid QTL, appears PWK founder allele driving interindividual variation ’re seeing three lipid phenotypes. next step perform mediation analysis (). mediation analysis, want look expressed gene molecular trait (e.g., region open chromatin, methylated region) whose interindividual variation expression/accessibility/etc aligns variation liver lipids seeing given distal QTL peak. Identification “causal intermediates” provide regulator-target hypotheses validation additional experiments. perform mediation analysis transcriptomic data, take gene expression data relevant tissue, liver, re-calculate LOD scores lipid QTL peaks, taking expression candidate mediator gene account additive covariate QTL mapping model. look genes largest LOD drop given phenotype within peak, indicating variation candidate mediator gene best explains distal QTL-driven variation lipid phenotype(s). run mediation, first load mm39-aligned liver expression data, specifically rankZ normalized data. using 3 phenotypes mapping chromosome 15, ’re going look genes within +/- 2Mb identified peak location (82953003) identify gene(s) whose variation expression best explain variation see phenotype. phenotype, identify top 5 mediators plot percent LOD drop heatmap.  plot, appears two predicted genes, predicted lncRNA gene Gm49463 predicted protein coding gene 5031439G07Rik, strong candidate mediators 3 phenotypes, corresponding high percent LOD drop distal lipid QTL peaks. verify , can look dataframe target mediator information, including rank significance. looks like genes first second ranked mediators 3 phenotypes, 5031439G07Rik consistently top ranked significant one.","code":"## Set significant and suggestive thresholds sig_LOD <- thlds$thlds$sigLOD sugg_LOD <- thlds$thlds$suggLOD  ## Calculate Effects eff_out <- qtl_effects(peaks       = map_peaks$peaks_list,                        mapping     = map_peaks$maps_list,                        suggLOD     = sugg_LOD,                         outdir      = \"../../_data/\",                         effects_out = \"liver_lipids_mm39_effects.rds\",                         save        = \"sr\") data checked peaks extracted, calculating effects now SLURM job detected, using 16 cores (16 tasks, 1 cores per task). SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). effects calculated. saving to RDS ## Combine significant peaks with effects peak_effects <- eff_out$peaks$liver |>    left_join(eff_out$effects_blup$liver |>                as.data.frame() |>                rownames_to_column(var = \"marker\"), by = join_by(marker)) ## Identify peaks to use map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD) |>    dplyr::group_by(peak_chr) |>    dplyr::count() # A tibble: 14 × 2 # Groups:   peak_chr [14]    peak_chr     n    <fct>    <int>  1 1            1  2 2            2  3 3            1  4 5            2  5 6            1  6 7            1  7 8            1  8 10           2  9 11           4 10 12           1 11 15          10 12 17           3 13 18           2 14 X            2 map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD, peak_chr == 15) |>    dplyr::arrange(peak_bp) phenotype peak_chr  peak_bp       lod    ci_lo 1                UNK_17.944_965.82587_plus       15 82953003  9.466032 82319925 2  TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 82288820 3  TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826 82319925 4                UNK_18.204_901.80334_plus       15 82977704 13.624220 82277678 5                UNK_16.716_949.80194_plus       15 82977704 12.481903 82288820 6                UNK_16.381_987.81036_plus       15 83968940  9.304922 82406369 7               UNK_16.905_1015.84003_plus       15 83968940 12.324044 82531636 8               UNK_17.448_1011.75751_plus       15 84016072 10.476459 82494131 9              UNK_18.104_1018.88293_minus       15 84085545 16.516295 82288820 10               UNK_14.308_596.59662_plus       15 84374485  8.581107 83950353       ci_hi 1  84576516 2  84576516 3  84576516 4  84576516 5  84576516 6  84576516 7  84576516 8  84576516 9  84374485 10 85513369 ## Set the position of the peak chr15_peak_pos <- 82953003  ## Subset the peak in order to get the features chr15_peak_sub <- map_peaks$peaks_list$liver |>    dplyr::filter(lod      >  sig_LOD,                  peak_chr == 15,                  peak_bp  == chr15_peak_pos)  ## Look at effects for the peaks on chromosome 15 peak_effects |> dplyr::filter(phenotype %in% chr15_peak_sub$phenotype, peak_chr == 15) |>    dplyr::select(phenotype, peak_chr, peak_bp, lod, marker, LETTERS[1:8]) phenotype peak_chr  peak_bp       lod 1               UNK_17.944_965.82587_plus       15 82953003  9.466032 2 TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 3 TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826        marker          A         B         C         D         E          F 1 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653 2 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653 3 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653            G         H 1 -0.8792315 0.1954129 2 -0.8792315 0.1954129 3 -0.8792315 0.1954129 ## Read in the expression data liver_expr <- readRDS(\"../../_data/dataset.liver.GRCm39.v1.rds\")  ## Use the normalized and rankZ transformed gene expression values for mediation liver_rz <- liver_expr$data$rz  ## clean up rm(\"liver_expr\")  ## Run mediation start_time <- Sys.time()  med_out <- multi_modiFinder(peaks   = map_peaks$peaks_list,                              mapping = map_peaks$maps_list,                              exprZ   = liver_rz,                              suggLOD = sugg_LOD,                              annots  = annot_105,                              outdir  = \"../../_data/\",                              med_out = \"liver_lipids_mm39_meds.rds\",                              save    = \"sr\") load annotations checking peaks and mapping data checked Number of common samples for liver: 369 filtered peaks liver running mediation SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). end_time <- Sys.time()  end_time - start_time Time difference of 7.897316 mins chr15_peak_med_rank <- medPlot_single(meds       = med_out$liver,                                       range      = 2,                                       position   = chr15_peak_pos,                                       feats      = chr15_peak_sub$phenotype,                                       chromosome = 15,                                       plot       = \"per_drop\",                                       psave      = F) Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` ## Filter ranked mediation results to candidate mediators chr15_peak_med_rank$meds_ranked |>    dplyr::filter(mediator %in% c(\"Gm49463\", \"5031439G07Rik\")) |>    dplyr::select(target_id, qtl_lod, qtl_chr, mediator, LOD, LOD_drop, padj, per_drop, ranks) # A tibble: 6 × 9   target_id         qtl_lod qtl_chr mediator   LOD LOD_drop  padj per_drop ranks   <chr>               <dbl> <fct>   <chr>    <dbl>    <dbl> <dbl>    <dbl> <dbl> 1 UNK_17.944_965.8…    9.47 15      Gm49463   2.81     6.65     0    0.703     2 2 UNK_17.944_965.8…    9.47 15      5031439…  2.49     6.98     0    0.737     1 3 TG_18.2_18.1_20.…    9.23 15      Gm49463   2.28     6.95     0    0.753     2 4 TG_18.2_18.1_20.…    9.23 15      5031439…  2.17     7.06     0    0.764     1 5 TG_18.1_18.1_22.…   10.0  15      Gm49463   4.67     5.37     0    0.535     2 6 TG_18.1_18.1_22.…   10.0  15      5031439…  4.32     5.73     0    0.570     1"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Founder Strain Effects at a QTL peak","title":null,"text":"can determine founder strain coefficients different QTL peaks. Now, going look peaks mapping across genome identify location multiple phenotypes associated . results 3 phenotypes map position chromosome 15, continue use example rest vignette. unfamiliar Diversity Outbred () mouse population, outbred population derived 8 founder inbred strains represented -H. letter corresponds different founder, order : AJ, B6, 129, NOD, NZO, CAST, PWK, WSB. Chromosome 15 lipid QTL, appears PWK founder allele driving interindividual variation ’re seeing three lipid phenotypes. next step perform mediation analysis ().","code":"## Set significant and suggestive thresholds sig_LOD <- thlds$thlds$sigLOD sugg_LOD <- thlds$thlds$suggLOD  ## Calculate Effects eff_out <- qtl_effects(peaks       = map_peaks$peaks_list,                        mapping     = map_peaks$maps_list,                        suggLOD     = sugg_LOD,                         outdir      = \"../../_data/\",                         effects_out = \"liver_lipids_mm39_effects.rds\",                         save        = \"sr\") data checked peaks extracted, calculating effects now SLURM job detected, using 16 cores (16 tasks, 1 cores per task). SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). effects calculated. saving to RDS ## Combine significant peaks with effects peak_effects <- eff_out$peaks$liver |>    left_join(eff_out$effects_blup$liver |>                as.data.frame() |>                rownames_to_column(var = \"marker\"), by = join_by(marker)) ## Identify peaks to use map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD) |>    dplyr::group_by(peak_chr) |>    dplyr::count() # A tibble: 14 × 2 # Groups:   peak_chr [14]    peak_chr     n    <fct>    <int>  1 1            1  2 2            2  3 3            1  4 5            2  5 6            1  6 7            1  7 8            1  8 10           2  9 11           4 10 12           1 11 15          10 12 17           3 13 18           2 14 X            2 map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD, peak_chr == 15) |>    dplyr::arrange(peak_bp) phenotype peak_chr  peak_bp       lod    ci_lo 1                UNK_17.944_965.82587_plus       15 82953003  9.466032 82319925 2  TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 82288820 3  TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826 82319925 4                UNK_18.204_901.80334_plus       15 82977704 13.624220 82277678 5                UNK_16.716_949.80194_plus       15 82977704 12.481903 82288820 6                UNK_16.381_987.81036_plus       15 83968940  9.304922 82406369 7               UNK_16.905_1015.84003_plus       15 83968940 12.324044 82531636 8               UNK_17.448_1011.75751_plus       15 84016072 10.476459 82494131 9              UNK_18.104_1018.88293_minus       15 84085545 16.516295 82288820 10               UNK_14.308_596.59662_plus       15 84374485  8.581107 83950353       ci_hi 1  84576516 2  84576516 3  84576516 4  84576516 5  84576516 6  84576516 7  84576516 8  84576516 9  84374485 10 85513369 ## Set the position of the peak chr15_peak_pos <- 82953003  ## Subset the peak in order to get the features chr15_peak_sub <- map_peaks$peaks_list$liver |>    dplyr::filter(lod      >  sig_LOD,                  peak_chr == 15,                  peak_bp  == chr15_peak_pos)  ## Look at effects for the peaks on chromosome 15 peak_effects |> dplyr::filter(phenotype %in% chr15_peak_sub$phenotype, peak_chr == 15) |>    dplyr::select(phenotype, peak_chr, peak_bp, lod, marker, LETTERS[1:8]) phenotype peak_chr  peak_bp       lod 1               UNK_17.944_965.82587_plus       15 82953003  9.466032 2 TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 3 TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826        marker          A         B         C         D         E          F 1 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653 2 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653 3 UNC25989251 0.06179842 0.5062977 0.1507991 0.2932127 -0.173424 -0.1548653            G         H 1 -0.8792315 0.1954129 2 -0.8792315 0.1954129 3 -0.8792315 0.1954129"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/Attie500_Liver_Lipids_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Mediation Analysis","title":null,"text":"mediation analysis, want look expressed gene molecular trait (e.g., region open chromatin, methylated region) whose interindividual variation expression/accessibility/etc aligns variation liver lipids seeing given distal QTL peak. Identification “causal intermediates” provide regulator-target hypotheses validation additional experiments. perform mediation analysis transcriptomic data, take gene expression data relevant tissue, liver, re-calculate LOD scores lipid QTL peaks, taking expression candidate mediator gene account additive covariate QTL mapping model. look genes largest LOD drop given phenotype within peak, indicating variation candidate mediator gene best explains distal QTL-driven variation lipid phenotype(s). run mediation, first load mm39-aligned liver expression data, specifically rankZ normalized data. using 3 phenotypes mapping chromosome 15, ’re going look genes within +/- 2Mb identified peak location (82953003) identify gene(s) whose variation expression best explain variation see phenotype. phenotype, identify top 5 mediators plot percent LOD drop heatmap.  plot, appears two predicted genes, predicted lncRNA gene Gm49463 predicted protein coding gene 5031439G07Rik, strong candidate mediators 3 phenotypes, corresponding high percent LOD drop distal lipid QTL peaks. verify , can look dataframe target mediator information, including rank significance. looks like genes first second ranked mediators 3 phenotypes, 5031439G07Rik consistently top ranked significant one.","code":"## Read in the expression data liver_expr <- readRDS(\"../../_data/dataset.liver.GRCm39.v1.rds\")  ## Use the normalized and rankZ transformed gene expression values for mediation liver_rz <- liver_expr$data$rz  ## clean up rm(\"liver_expr\")  ## Run mediation start_time <- Sys.time()  med_out <- multi_modiFinder(peaks   = map_peaks$peaks_list,                              mapping = map_peaks$maps_list,                              exprZ   = liver_rz,                              suggLOD = sugg_LOD,                              annots  = annot_105,                              outdir  = \"../../_data/\",                              med_out = \"liver_lipids_mm39_meds.rds\",                              save    = \"sr\") load annotations checking peaks and mapping data checked Number of common samples for liver: 369 filtered peaks liver running mediation SLURM job detected, using 16 cores (16 tasks, 1 cores per task). Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). end_time <- Sys.time()  end_time - start_time Time difference of 7.897316 mins chr15_peak_med_rank <- medPlot_single(meds       = med_out$liver,                                       range      = 2,                                       position   = chr15_peak_pos,                                       feats      = chr15_peak_sub$phenotype,                                       chromosome = 15,                                       plot       = \"per_drop\",                                       psave      = F) Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` ## Filter ranked mediation results to candidate mediators chr15_peak_med_rank$meds_ranked |>    dplyr::filter(mediator %in% c(\"Gm49463\", \"5031439G07Rik\")) |>    dplyr::select(target_id, qtl_lod, qtl_chr, mediator, LOD, LOD_drop, padj, per_drop, ranks) # A tibble: 6 × 9   target_id         qtl_lod qtl_chr mediator   LOD LOD_drop  padj per_drop ranks   <chr>               <dbl> <fct>   <chr>    <dbl>    <dbl> <dbl>    <dbl> <dbl> 1 UNK_17.944_965.8…    9.47 15      Gm49463   2.81     6.65     0    0.703     2 2 UNK_17.944_965.8…    9.47 15      5031439…  2.49     6.98     0    0.737     1 3 TG_18.2_18.1_20.…    9.23 15      Gm49463   2.28     6.95     0    0.753     2 4 TG_18.2_18.1_20.…    9.23 15      5031439…  2.17     7.06     0    0.764     1 5 TG_18.1_18.1_22.…   10.0  15      Gm49463   4.67     5.37     0    0.535     2 6 TG_18.1_18.1_22.…   10.0  15      5031439…  4.32     5.73     0    0.570     1"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Islet Transcriptomics Example","text":"vignette demonstrate using QTLretrievR Attie DO500 dataset available QTLviewer published Nature Communications. using islet transcriptomics dataset mice genotyped using Neogen GigaMUGA 143k SNP array. First set environment loading QTLretrievR tidyverse. Next load data. cleanup objects need QTLretrievR preserved environment. markers associated genoprobs GigaMUGA grid map, .Rdata file need retain genoprobs object, since GigaMUGA gridfile available QTLretrievR. liver_lipids object, want retain: - annot.samples - $data$norm sample annotations, normalized lipid counts.","code":"## read in data load(\"../../_data/attie.core.GRCm39.v1.Rdata\") options(timeout = 600) islet <- readRDS(url(\"https://churchilllab.jax.org/qtlviewer/attie/DO500HFD/dl?fileName=Islet.RDS\"))  ## save annotations (metadata) and normalized counts sample_meta <- as.data.frame(islet$annot.samples) sample_meta <- sample_meta |>    dplyr::select(ID = mouse.id, sex = Sex, ngen = Generation)  norm_counts <- islet$data$norm  ## clean up rm(ensembl_version, K, islet, map, markers)"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"running-qtlretrievr","dir":"Articles","previous_headings":"","what":"Running QTLretrievR","title":"Islet Transcriptomics Example","text":"Now data set R environment cleaned , ’re ready start running QTLretrievR. already genoprobs correct format (founder allele probabilities). see general overview impute genotype probabilities GigaMUGA SNP-level calls, please see overview vignette. demo show running peak calling, effects calculation, mediation analysis steps separately. wish run three steps together, can use runQTL function. run option, keep mind effects mediation steps require input LOD score threshold, filter identifying suggestive significant LOD scores. following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. running , QTLretrievR takes total number genes (22180) breaks groups 1000 genes. takes available cores (32) divides number tissues (1), divides minimum number cores (8) determine many scan1 processes run simultaneously tissue (4). Based benchmarking results (shown ) takes ~7.75 hours run mapping peak calling start finish. calculated peaks need determine considered significant suggestive LOD score. Using LOD_thld function can parallelize thresholding run thousands permutations multiple autosomal genes simultaneously. default LOD_thld runs 1000 permutations 10 autosomal genes 2 parallel processes. testing found taking median threshold multiple genes yields comparable significance threshold running permutations individual gene determine thresholds. Taking multiple genes account stabilizes resulting LOD threshold choosing single gene running >1000 permutations . Now significant suggestive LOD thresholds identified can visualize eQTL map look individual peaks. significance threshold used original study 8 Unclear whether tissue specific across tissues, using islet expression data calculate significant suggestive LOD thresholds get 7.68 6.34 respectively.  Compare threshold QTL Viewer addition can look peak associated Pparg one genes interest study.","code":"## Perform QTL Mapping  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"islet_mm39_GM_peaks.rds\",                     map_out       = \"islet_mm39_GM_map.rds\",                     genoprobs     = list(\"islet\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"islet\" = t(norm_counts)),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"so\",                     min_cores     = 8,                     total_cores   = 32) ## Load in the map and peaks objects so that they can be used downstream maps_list <- readRDS(\"../../_data/islet_mm39_GM_map.rds\") peaks_list <- readRDS(\"../../_data/islet_mm39_GM_peaks.rds\") islet_thlds <- LOD_thld(mapping = maps_list,                         tissue  = \"islet\",                         annots  = annot_105)  saveRDS(islet_thlds, \"../../_data/islet_thlds.rds\") ## load in the thresholds for use downstream islet_thlds <- readRDS(\"../../_data/islet_thlds.rds\")  ## save suggestive and significant thresholds to variables  sigTHLD <- islet_thlds$thlds$sigLOD suggTHLD <- islet_thlds$thlds$suggLOD plot_eqtlmap(map_dat = maps_list$map_dat2,              peaks   = peaks_list,              sigLOD  = round(sigTHLD, 2),              psave   = F) $islet Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_point()`). peak_plot(mapping = maps_list,           tissue  = \"islet\",           pheno   = \"ENSMUSG00000000440\",           pop     = \"do\",           psave   = F) Working in Linux and there are 40 cores in total. NULL peak_plot(mapping    = maps_list,           tissue     = \"islet\",           pheno      = \"ENSMUSG00000000440\",           chromosome = 6,           pop        = \"do\",           effects    = T,            psave      = F) Working in Linux and there are 40 cores in total. calculating effects NULL"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"mapping-peak-calling","dir":"Articles","previous_headings":"","what":"Mapping & Peak Calling","title":"Islet Transcriptomics Example","text":"following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. running , QTLretrievR takes total number genes (22180) breaks groups 1000 genes. takes available cores (32) divides number tissues (1), divides minimum number cores (8) determine many scan1 processes run simultaneously tissue (4). Based benchmarking results (shown ) takes ~7.75 hours run mapping peak calling start finish.","code":"## Perform QTL Mapping  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"islet_mm39_GM_peaks.rds\",                     map_out       = \"islet_mm39_GM_map.rds\",                     genoprobs     = list(\"islet\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"islet\" = t(norm_counts)),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"so\",                     min_cores     = 8,                     total_cores   = 32)"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"lod-thresholding","dir":"Articles","previous_headings":"","what":"LOD Thresholding","title":"Islet Transcriptomics Example","text":"calculated peaks need determine considered significant suggestive LOD score. Using LOD_thld function can parallelize thresholding run thousands permutations multiple autosomal genes simultaneously. default LOD_thld runs 1000 permutations 10 autosomal genes 2 parallel processes. testing found taking median threshold multiple genes yields comparable significance threshold running permutations individual gene determine thresholds. Taking multiple genes account stabilizes resulting LOD threshold choosing single gene running >1000 permutations .","code":"## Load in the map and peaks objects so that they can be used downstream maps_list <- readRDS(\"../../_data/islet_mm39_GM_map.rds\") peaks_list <- readRDS(\"../../_data/islet_mm39_GM_peaks.rds\") islet_thlds <- LOD_thld(mapping = maps_list,                         tissue  = \"islet\",                         annots  = annot_105)  saveRDS(islet_thlds, \"../../_data/islet_thlds.rds\") ## load in the thresholds for use downstream islet_thlds <- readRDS(\"../../_data/islet_thlds.rds\")  ## save suggestive and significant thresholds to variables  sigTHLD <- islet_thlds$thlds$sigLOD suggTHLD <- islet_thlds$thlds$suggLOD"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"initial-visualization","dir":"Articles","previous_headings":"","what":"Initial Visualization","title":"Islet Transcriptomics Example","text":"Now significant suggestive LOD thresholds identified can visualize eQTL map look individual peaks. significance threshold used original study 8 Unclear whether tissue specific across tissues, using islet expression data calculate significant suggestive LOD thresholds get 7.68 6.34 respectively.  Compare threshold QTL Viewer addition can look peak associated Pparg one genes interest study.","code":"plot_eqtlmap(map_dat = maps_list$map_dat2,              peaks   = peaks_list,              sigLOD  = round(sigTHLD, 2),              psave   = F) $islet Warning: Removed 5 rows containing missing values or values outside the scale range (`geom_point()`). peak_plot(mapping = maps_list,           tissue  = \"islet\",           pheno   = \"ENSMUSG00000000440\",           pop     = \"do\",           psave   = F) Working in Linux and there are 40 cores in total. NULL peak_plot(mapping    = maps_list,           tissue     = \"islet\",           pheno      = \"ENSMUSG00000000440\",           chromosome = 6,           pop        = \"do\",           effects    = T,            psave      = F) Working in Linux and there are 40 cores in total. calculating effects NULL"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Islet Transcriptomics Example","text":"number next steps can taken follow peak identification thresholding. include ascertaining founder strain alleles responsible driving observed QTL effect, performing mediation analysis identify potential causal intermediates responsible conferring QTL.analyses described . can identify distal eQTL hotspots (transbands) significant suggestive peaks using transbands function. uses sliding windows 50 markers wide counts number significant suggestive distal peaks within windows slide across chromosome. Windows top 0.5% peak density selected collapsed continuous bands.  Note hotspots chromosomes 2, 5, 7, 11, 12, 13. can determine founder strain coefficients different QTL peaks. Now look strain effects hotspot chromosome 2.  couple ways can mediation, can mediate within islet expression data, can mediate islet expression data phenotypic data collected samples. Within tissue mediation straightforward modiFinder function. builds mediation package r/intermediate take expression genes account mapping peak calling. Now can examine introducing expression genes located within hotspot influences variation expression genes map back hotspot. Note mediation plot showing top 5 mediatiors target based LOD drop.  Visually, looks top mediator targets hotspot Hnf4a, inspection ranked mediation results verifies . Next can look PC1 hotspot targets visualize Hnf4a located respect peak.  , can run mediation using PC1 phenotype taking expression genes local hotspot account.","code":"tbands <- transbands(map_dat = maps_list$map_dat2,                       peaks   = peaks_list,                       sigLOD  = round(sigTHLD, 2),                       suggLOD = round(suggTHLD, 2),                       psave   = F) identifying hotspots generating plots 163819331.5 145579467.5 45590508 69642292 71233450.5 73377066.5 113106029.5 66018865.5 111866654 2 5 7 11 12 13 358833665.5 838197443.5 1039333294 1592508381 1594099539.5 1596243155.5 1757831005.5 1830725007.5 1876572796 tbands$bands.rna$islet # A tibble: 9 × 8   seqnames     start       end   width strand distant_rna distant_rna_sugg chr   <fct>        <int>     <int>   <int> <fct>        <int>            <int> <fct> 1 2        162637473 165001190 2363718 *              139              210 2 2 5        143584435 147574500 3990066 *              125              344 5 3 7         44389033  46791983 2402951 *               71              203 7 4 11        68872949  70411635 1538687 *               32              137 11 5 11        70421517  72045384 1623868 *               69              170 11 6 11        72485997  74268136 1782140 *               36              129 11 7 12       112222853 113989206 1766354 *               28               45 12 8 13        64526964  67510767 2983804 *               24               25 13 9 13       110877549 112855759 1978211 *               67              151 13 tbands$trans_band_plot$islet ## Calculate Effects effects_list <- qtl_effects(peaks   = peaks_list,                             mapping = maps_list,                             suggLOD = islet_thlds$thlds$suggLOD,                             outdir  = \"../../_data/\",                             outfile = \"islet_mm39_GM_effects.rds\",                             save    = \"so\") effects_list <- readRDS(\"../../_data/islet_mm39_GM_effects.rds\") hs_plots <- hsHapEffects(effects    = effects_list,                          tbands     = tbands$bands.rna,                          chromosome = 2,                          tissue     = \"islet\",                           sigLOD     = 9,                           pop        = \"do\",                           vert       = TRUE,                          showTarg   = FALSE,                          psave      = FALSE)  hs_plots$ht_plot meds_list <- modiFinder(peaks   = peaks_list,                         mapping = maps_list,                         suggLOD = round(suggTHLD, 2),                         annots  = annot_105,                         outdir  = \"../../_data/\",                         med_out = \"islet_mm39_GM_meds.rds\",                         save    = \"so\") meds_list <- readRDS(\"../../_data/islet_mm39_GM_meds.rds\") chr2_hs_med <- medPlot_hotSpot(peaks      = peaks_list$islet,                                 meds       = meds_list$islet,                                 tbands     = tbands$bands.rna$islet,                                 sigLOD     = 9,                                 chromosome = 2,                                hsNum      = 1,                                 top_n      = 5,                                showTarg   = FALSE,                                psave      = FALSE,                                 plot       = \"padj\") chr2_hs_med$meds_ranked |>    dplyr::filter(ranks <= 1) |>    dplyr::group_by(mediator) |>    dplyr::count() |>    dplyr::arrange(desc(n)) # A tibble: 15 × 2 # Groups:   mediator [15]    mediator     n    <chr>    <int>  1 Hnf4a       77  2 Mybl2        4  3 Sgk2         3  4 Ctsa         2  5 Gdap1l1      1  6 L3mbtl1      1  7 Neurl2       1  8 Pabpc1l      1  9 Pkig         1 10 Rims4        1 11 Slc12a5      1 12 Slpi         1 13 Snx21        1 14 Stk4         1 15 Tomm34       1 ## Identify targets of chromosome 2 hotspot chr_2_targets <- unique(chr2_hs_med$meds_ranked$target_id)  ## Dataframe of candidate mediator (Hnf4a) cM <- annot_105 |> dplyr::filter(symbol == \"Hnf4a\")  ## Run plotting/PC analysis pc_effects <- hsPeakPlot(mapping      = maps_list,                          feats        = chr_2_targets,                           tbands       = tbands$bands.rna,                          chromosome   = 2,                          tissue       = \"islet\",                           candidateMed = cM,                          pc           = TRUE,                           wag          = TRUE,                           sigLOD       = round(sigTHLD, 2),                           psave        = FALSE) Working in Linux and there are 40 cores in total. Joining with `by = join_by(marker)` Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ℹ Please use `linewidth` instead. ℹ The deprecated feature was likely used in the QTLretrievR package.   Please report the issue to the authors. Warning in data.frame(..., check.names = FALSE): row names were found from a short variable and have been discarded pc_effects$pwork Warning: Removed 6545 rows containing missing values or values outside the scale range (`geom_line()`). ## Make a mapping object for the PC and limit it to just the kidney mapping info is included pc_map <- maps_list pc_map$expr_list <- list(\"islet\" = t(pc_effects$pca_rz)) pc_map$exprZ_list <- list(\"islet\" = pc_effects$pca_rz) pc_map$qtlprobs <- list(\"islet\" = pc_map$qtlprobs$islet) pc_map$kinship_loco <- list(\"islet\" = pc_map$kinship_loco$islet) pc_map$covar_list <- list(\"islet\" = pc_map$covar_list$islet) pc_map$tissue_samp <- list(\"islet\" = pc_map$tissue_samp$islet)  chr2_meds <- unique(chr2_hs_med$meds_ranked$mediator_id)  pc_med <- multi_modiFinder(peaks   = list(\"islet\" = pc_effects$peaks),                             mapping = pc_map,                             exprZ   = maps_list$exprZ_list$islet[, chr2_meds],                             suggLOD = round(suggTHLD, 2),                             annots  = annot_105,                             save    = \"ro\") load annotations checking peaks and mapping data checked Number of common samples for islet: 363 filtered peaks islet running mediation Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). pc_med_plot <- medPlot_single(meds       = pc_med$islet,                               range      = 5,                                position   = pc_effects$peaks$peak_bp[which(pc_effects$peaks$peak_chr == 2)],                                feats      = \"PC1\",                                chromosome = 2,                                psave      = FALSE,                                plot       = \"per_drop\") Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` pc_med_plot$meds_ranked |>    dplyr::filter(ranks <= 5) |>    dplyr::arrange(ranks) |>    dplyr::select(mediator, ranks) # A tibble: 5 × 2   mediator ranks   <chr>    <dbl> 1 Hnf4a        1 2 Fitm2        2 3 Slc12a5      3 4 Pabpc1l      4 5 Tomm34       5"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"transband-identification","dir":"Articles","previous_headings":"","what":"Transband Identification","title":"Islet Transcriptomics Example","text":"can identify distal eQTL hotspots (transbands) significant suggestive peaks using transbands function. uses sliding windows 50 markers wide counts number significant suggestive distal peaks within windows slide across chromosome. Windows top 0.5% peak density selected collapsed continuous bands.  Note hotspots chromosomes 2, 5, 7, 11, 12, 13.","code":"tbands <- transbands(map_dat = maps_list$map_dat2,                       peaks   = peaks_list,                       sigLOD  = round(sigTHLD, 2),                       suggLOD = round(suggTHLD, 2),                       psave   = F) identifying hotspots generating plots 163819331.5 145579467.5 45590508 69642292 71233450.5 73377066.5 113106029.5 66018865.5 111866654 2 5 7 11 12 13 358833665.5 838197443.5 1039333294 1592508381 1594099539.5 1596243155.5 1757831005.5 1830725007.5 1876572796 tbands$bands.rna$islet # A tibble: 9 × 8   seqnames     start       end   width strand distant_rna distant_rna_sugg chr   <fct>        <int>     <int>   <int> <fct>        <int>            <int> <fct> 1 2        162637473 165001190 2363718 *              139              210 2 2 5        143584435 147574500 3990066 *              125              344 5 3 7         44389033  46791983 2402951 *               71              203 7 4 11        68872949  70411635 1538687 *               32              137 11 5 11        70421517  72045384 1623868 *               69              170 11 6 11        72485997  74268136 1782140 *               36              129 11 7 12       112222853 113989206 1766354 *               28               45 12 8 13        64526964  67510767 2983804 *               24               25 13 9 13       110877549 112855759 1978211 *               67              151 13 tbands$trans_band_plot$islet"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"founder-strain-effects-at-a-qtl-peak","dir":"Articles","previous_headings":"","what":"Founder Strain Effects at a QTL peak","title":"Islet Transcriptomics Example","text":"can determine founder strain coefficients different QTL peaks. Now look strain effects hotspot chromosome 2.","code":"## Calculate Effects effects_list <- qtl_effects(peaks   = peaks_list,                             mapping = maps_list,                             suggLOD = islet_thlds$thlds$suggLOD,                             outdir  = \"../../_data/\",                             outfile = \"islet_mm39_GM_effects.rds\",                             save    = \"so\") effects_list <- readRDS(\"../../_data/islet_mm39_GM_effects.rds\") hs_plots <- hsHapEffects(effects    = effects_list,                          tbands     = tbands$bands.rna,                          chromosome = 2,                          tissue     = \"islet\",                           sigLOD     = 9,                           pop        = \"do\",                           vert       = TRUE,                          showTarg   = FALSE,                          psave      = FALSE)  hs_plots$ht_plot"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"mediation-analysis","dir":"Articles","previous_headings":"","what":"Mediation Analysis","title":"Islet Transcriptomics Example","text":"couple ways can mediation, can mediate within islet expression data, can mediate islet expression data phenotypic data collected samples. Within tissue mediation straightforward modiFinder function. builds mediation package r/intermediate take expression genes account mapping peak calling. Now can examine introducing expression genes located within hotspot influences variation expression genes map back hotspot. Note mediation plot showing top 5 mediatiors target based LOD drop.  Visually, looks top mediator targets hotspot Hnf4a, inspection ranked mediation results verifies . Next can look PC1 hotspot targets visualize Hnf4a located respect peak.  , can run mediation using PC1 phenotype taking expression genes local hotspot account.","code":"meds_list <- modiFinder(peaks   = peaks_list,                         mapping = maps_list,                         suggLOD = round(suggTHLD, 2),                         annots  = annot_105,                         outdir  = \"../../_data/\",                         med_out = \"islet_mm39_GM_meds.rds\",                         save    = \"so\") meds_list <- readRDS(\"../../_data/islet_mm39_GM_meds.rds\") chr2_hs_med <- medPlot_hotSpot(peaks      = peaks_list$islet,                                 meds       = meds_list$islet,                                 tbands     = tbands$bands.rna$islet,                                 sigLOD     = 9,                                 chromosome = 2,                                hsNum      = 1,                                 top_n      = 5,                                showTarg   = FALSE,                                psave      = FALSE,                                 plot       = \"padj\") chr2_hs_med$meds_ranked |>    dplyr::filter(ranks <= 1) |>    dplyr::group_by(mediator) |>    dplyr::count() |>    dplyr::arrange(desc(n)) # A tibble: 15 × 2 # Groups:   mediator [15]    mediator     n    <chr>    <int>  1 Hnf4a       77  2 Mybl2        4  3 Sgk2         3  4 Ctsa         2  5 Gdap1l1      1  6 L3mbtl1      1  7 Neurl2       1  8 Pabpc1l      1  9 Pkig         1 10 Rims4        1 11 Slc12a5      1 12 Slpi         1 13 Snx21        1 14 Stk4         1 15 Tomm34       1 ## Identify targets of chromosome 2 hotspot chr_2_targets <- unique(chr2_hs_med$meds_ranked$target_id)  ## Dataframe of candidate mediator (Hnf4a) cM <- annot_105 |> dplyr::filter(symbol == \"Hnf4a\")  ## Run plotting/PC analysis pc_effects <- hsPeakPlot(mapping      = maps_list,                          feats        = chr_2_targets,                           tbands       = tbands$bands.rna,                          chromosome   = 2,                          tissue       = \"islet\",                           candidateMed = cM,                          pc           = TRUE,                           wag          = TRUE,                           sigLOD       = round(sigTHLD, 2),                           psave        = FALSE) Working in Linux and there are 40 cores in total. Joining with `by = join_by(marker)` Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ℹ Please use `linewidth` instead. ℹ The deprecated feature was likely used in the QTLretrievR package.   Please report the issue to the authors. Warning in data.frame(..., check.names = FALSE): row names were found from a short variable and have been discarded pc_effects$pwork Warning: Removed 6545 rows containing missing values or values outside the scale range (`geom_line()`). ## Make a mapping object for the PC and limit it to just the kidney mapping info is included pc_map <- maps_list pc_map$expr_list <- list(\"islet\" = t(pc_effects$pca_rz)) pc_map$exprZ_list <- list(\"islet\" = pc_effects$pca_rz) pc_map$qtlprobs <- list(\"islet\" = pc_map$qtlprobs$islet) pc_map$kinship_loco <- list(\"islet\" = pc_map$kinship_loco$islet) pc_map$covar_list <- list(\"islet\" = pc_map$covar_list$islet) pc_map$tissue_samp <- list(\"islet\" = pc_map$tissue_samp$islet)  chr2_meds <- unique(chr2_hs_med$meds_ranked$mediator_id)  pc_med <- multi_modiFinder(peaks   = list(\"islet\" = pc_effects$peaks),                             mapping = pc_map,                             exprZ   = maps_list$exprZ_list$islet[, chr2_meds],                             suggLOD = round(suggTHLD, 2),                             annots  = annot_105,                             save    = \"ro\") load annotations checking peaks and mapping data checked Number of common samples for islet: 363 filtered peaks islet running mediation Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). pc_med_plot <- medPlot_single(meds       = pc_med$islet,                               range      = 5,                                position   = pc_effects$peaks$peak_bp[which(pc_effects$peaks$peak_chr == 2)],                                feats      = \"PC1\",                                chromosome = 2,                                psave      = FALSE,                                plot       = \"per_drop\") Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` pc_med_plot$meds_ranked |>    dplyr::filter(ranks <= 5) |>    dplyr::arrange(ranks) |>    dplyr::select(mediator, ranks) # A tibble: 5 × 2   mediator ranks   <chr>    <dbl> 1 Hnf4a        1 2 Fitm2        2 3 Slc12a5      3 4 Pabpc1l      4 5 Tomm34       5"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_Islet.html","id":"within-tissue-mediation","dir":"Articles","previous_headings":"Next Steps","what":"Within Tissue Mediation","title":"Islet Transcriptomics Example","text":"Within tissue mediation straightforward modiFinder function. builds mediation package r/intermediate take expression genes account mapping peak calling. Now can examine introducing expression genes located within hotspot influences variation expression genes map back hotspot. Note mediation plot showing top 5 mediatiors target based LOD drop.  Visually, looks top mediator targets hotspot Hnf4a, inspection ranked mediation results verifies . Next can look PC1 hotspot targets visualize Hnf4a located respect peak.  , can run mediation using PC1 phenotype taking expression genes local hotspot account.","code":"meds_list <- modiFinder(peaks   = peaks_list,                         mapping = maps_list,                         suggLOD = round(suggTHLD, 2),                         annots  = annot_105,                         outdir  = \"../../_data/\",                         med_out = \"islet_mm39_GM_meds.rds\",                         save    = \"so\") meds_list <- readRDS(\"../../_data/islet_mm39_GM_meds.rds\") chr2_hs_med <- medPlot_hotSpot(peaks      = peaks_list$islet,                                 meds       = meds_list$islet,                                 tbands     = tbands$bands.rna$islet,                                 sigLOD     = 9,                                 chromosome = 2,                                hsNum      = 1,                                 top_n      = 5,                                showTarg   = FALSE,                                psave      = FALSE,                                 plot       = \"padj\") chr2_hs_med$meds_ranked |>    dplyr::filter(ranks <= 1) |>    dplyr::group_by(mediator) |>    dplyr::count() |>    dplyr::arrange(desc(n)) # A tibble: 15 × 2 # Groups:   mediator [15]    mediator     n    <chr>    <int>  1 Hnf4a       77  2 Mybl2        4  3 Sgk2         3  4 Ctsa         2  5 Gdap1l1      1  6 L3mbtl1      1  7 Neurl2       1  8 Pabpc1l      1  9 Pkig         1 10 Rims4        1 11 Slc12a5      1 12 Slpi         1 13 Snx21        1 14 Stk4         1 15 Tomm34       1 ## Identify targets of chromosome 2 hotspot chr_2_targets <- unique(chr2_hs_med$meds_ranked$target_id)  ## Dataframe of candidate mediator (Hnf4a) cM <- annot_105 |> dplyr::filter(symbol == \"Hnf4a\")  ## Run plotting/PC analysis pc_effects <- hsPeakPlot(mapping      = maps_list,                          feats        = chr_2_targets,                           tbands       = tbands$bands.rna,                          chromosome   = 2,                          tissue       = \"islet\",                           candidateMed = cM,                          pc           = TRUE,                           wag          = TRUE,                           sigLOD       = round(sigTHLD, 2),                           psave        = FALSE) Working in Linux and there are 40 cores in total. Joining with `by = join_by(marker)` Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ℹ Please use `linewidth` instead. ℹ The deprecated feature was likely used in the QTLretrievR package.   Please report the issue to the authors. Warning in data.frame(..., check.names = FALSE): row names were found from a short variable and have been discarded pc_effects$pwork Warning: Removed 6545 rows containing missing values or values outside the scale range (`geom_line()`). ## Make a mapping object for the PC and limit it to just the kidney mapping info is included pc_map <- maps_list pc_map$expr_list <- list(\"islet\" = t(pc_effects$pca_rz)) pc_map$exprZ_list <- list(\"islet\" = pc_effects$pca_rz) pc_map$qtlprobs <- list(\"islet\" = pc_map$qtlprobs$islet) pc_map$kinship_loco <- list(\"islet\" = pc_map$kinship_loco$islet) pc_map$covar_list <- list(\"islet\" = pc_map$covar_list$islet) pc_map$tissue_samp <- list(\"islet\" = pc_map$tissue_samp$islet)  chr2_meds <- unique(chr2_hs_med$meds_ranked$mediator_id)  pc_med <- multi_modiFinder(peaks   = list(\"islet\" = pc_effects$peaks),                             mapping = pc_map,                             exprZ   = maps_list$exprZ_list$islet[, chr2_meds],                             suggLOD = round(suggTHLD, 2),                             annots  = annot_105,                             save    = \"ro\") load annotations checking peaks and mapping data checked Number of common samples for islet: 363 filtered peaks islet running mediation Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). pc_med_plot <- medPlot_single(meds       = pc_med$islet,                               range      = 5,                                position   = pc_effects$peaks$peak_bp[which(pc_effects$peaks$peak_chr == 2)],                                feats      = \"PC1\",                                chromosome = 2,                                psave      = FALSE,                                plot       = \"per_drop\") Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` pc_med_plot$meds_ranked |>    dplyr::filter(ranks <= 5) |>    dplyr::arrange(ranks) |>    dplyr::select(mediator, ranks) # A tibble: 5 × 2   mediator ranks   <chr>    <dbl> 1 Hnf4a        1 2 Fitm2        2 3 Slc12a5      3 4 Pabpc1l      4 5 Tomm34       5"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Lipidomics Example","text":"vignette demonstrate using QTLretrievR Attie DO500 dataset available QTLviewer published nature metabolism. using liver lipids dataset mice genotyped using Neogen GigaMUGA 143k SNP array. First set environment loading QTLretrievR tidyverse. Next load data. cleanup objects need QTLretrievR preserved environment. markers associated genoprobs GigaMUGA grid map, .Rdata file need retain genoprobs object, since GigaMUGA gridfile available QTLretrievR. liver_lipids object, want retain: - annot.samples - $data$norm sample annotations, normalized lipid counts.","code":"## read in data load(\"../../_data/attie.core.GRCm39.v1.Rdata\") liver_lipids <- readRDS(url(\"https://churchilllab.jax.org/qtlviewer/attie/DO500HFD/dl?fileName=LiverLipids_Phenotypes_V11.rds\"))  ## save annotations (metadata) and normalized counts sample_meta <- as.data.frame(liver_lipids$annot.samples) sample_meta <- sample_meta |>    dplyr::select(ID = MouseID, sex = Sex)  norm_counts <- liver_lipids$data$norm  ## clean up rm(ensembl_version, K, liver_lipids, map, markers)"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"running-qtlretrievr","dir":"Articles","previous_headings":"","what":"Running QTLretrievR","title":"Lipidomics Example","text":"Now data set R environment cleaned , ’re ready start running QTLretrievR. already genoprobs correct format (founder allele probabilities). see general overview impute genotype probabilities GigaMUGA SNP-level calls, please see overview vignette. demo show running peak calling, effects calculation, mediation analysis steps separately. wish run three steps together, can use runQTL function. run option, keep mind effects mediation steps require input suggestive LOD score threshold, filter identifying suggestive significant LOD scores. following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. may notice 16 cores found available Linux system, 8 registered used peak calling. < 1000 phenotypes, found using 8 cores appreciably decrease amount time used peak calling. now briefly look map_peaks object looks like. QTLretrievR returns everything list format separating everything based tissue. Since using liver lipids, tissue liver. using lipid measurements multiple tissues, lists length > 1 named tissue. maps_list peaks_list list element map_peaks$maps_list object list objects different tissues. maps_list preserves following future use either plotting functions, want re-run specific tissue phenotype. qtlprobs: Genotype probabilities (founder allele probabilities) tissue (separated chromosome within tissues, samples x allele x marker) covar_list: Covariate dataframes tissue. Covariates may include sex, diet, age, batch number, etc. expr_list: Copy normalized expression matrices tissue (phenotype x samples) exprZ_list: Copy rankZ transformed expression matrices tissue (samples x phenotype) kinship_loco: Sample kinship matrix tissue, calculated sample genoprobs using leave one chromosome (loco) method (separated chromosome within tissues, samples x samples) gmap: Genetic map markers (centiMorgans cM, separated chromosome) map_dat2: Dataframe markers, genetic physical positions, order markers appear genome. pmap: Physical map markers (basepairs bp, separated chromosome) tissue_samp: Copy sample metadata separated tissue like genetic map distances (cM) rather physical map distances (bp) QTL peaks, can use interp_cM, can use phys = F call mapQTL runQTL. default QTLretrievR return LOD scores < 5; like change threshold, can use thrA thrX autosomes X chromosome, respectively. can also visualize peaks look like overall.  visualize allelic effects occurring specific peak.  calculated peaks, good idea determine significant suggestive LOD thresholds. help us determine phenotypes/QTLs investigate . performing eQTL mapping, can also influence peaks included characterization distal hotspot. , use function LOD_thld; choose 5 lipid phenotypes run 500 permutations , take median values determine significant (alpha = 0.05) suggestive (alpha = 0.4) LOD thresholds. default function use 100 phenotypes run 750 permutations . number appropriate eQTL analyses many thousands gene expression phenotypes, unnecessary ~1500 liver lipids. return permutations object well significant suggestive LODs named list. significant suggestive LOD thresholds 7.697 6.297 respectively, use values mediation analysis haplotype effect identification.","code":"## Downsample to 200 liver lipids phenotypes <- sample(colnames(norm_counts), 200, replace = FALSE)  ## Perform QTL Mapping start_time <- Sys.time()  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"liver_lipids_GM_peaks_sub.rds\",                     map_out       = \"liver_lipids_GM_map_sub.rds\",                     genoprobs     = list(\"liver\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"liver\" = t(norm_counts[,phenotypes])),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"ro\") checking probabilities liver gmap complete pmap complete expression loaded Working with 369 samples and 200 genes in liver. rankZ normalized covariates calculated calculating peaks Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). Does that look right? If not please                  set total_cores parameter to the number of available cores. end_time <- Sys.time()  end_time - start_time Time difference of 21.18292 mins names(map_peaks$maps_list) [1] \"qtlprobs\"     \"covar_list\"   \"expr_list\"    \"exprZ_list\"   \"kinship_loco\" [6] \"gmap\"         \"map_dat2\"     \"pmap\"         \"tissue_samp\" str(map_peaks$maps_list$qtlprobs$liver[[1]]) num [1:483, 1:8, 1:9449] 1.26e-03 8.19e-03 8.20e-03 8.20e-03 8.47e-08 ...  - attr(*, \"dimnames\")=List of 3   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ...   ..$ : chr [1:9449] \"UNC6\" \"UNCHS000001\" \"JAX00000010\" \"JAX00000010r\" ... str(map_peaks$maps_list$kinship_loco$liver[[1]]) num [1:483, 1:483] 0.553 0.13 0.149 0.13 0.156 ...  - attr(*, \"n_pos\")= int 114433  - attr(*, \"dimnames\")=List of 2   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ... str(map_peaks$peaks_list) List of 1  $ liver:'data.frame':  906 obs. of  6 variables:   ..$ phenotype: chr [1:906] \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" ...   ..$ peak_chr : Factor w/ 20 levels \"1\",\"2\",\"3\",\"4\",..: 5 11 12 15 20 3 5 8 10 11 ...   ..$ peak_bp  : num [1:906] 7.68e+07 6.19e+06 1.19e+07 6.79e+07 1.59e+08 ...   ..$ lod      : num [1:906] 5.85 5.19 5.02 6.86 5.21 ...   ..$ ci_lo    : num [1:906] 72517079 3070782 3082700 65182973 12309718 ...   ..$ ci_hi    : num [1:906] 9.73e+07 1.16e+08 8.70e+07 7.03e+07 1.63e+08 ... summary(map_peaks$peaks_list$liver) phenotype            peak_chr      peak_bp               lod  Length:906         15     : 67   Min.   :  3309356   Min.   : 5.001  Class :character   6      : 59   1st Qu.: 43624520   1st Qu.: 5.239  Mode  :character   18     : 59   Median : 76768036   Median : 5.517                     11     : 57   Mean   : 77905714   Mean   : 5.872                     5      : 56   3rd Qu.:111810346   3rd Qu.: 5.981                     X      : 56   Max.   :193382813   Max.   :28.765                     (Other):552      ci_lo               ci_hi  Min.   :  3050998   Min.   :  6461844  1st Qu.:  9575738   1st Qu.: 83157539  Median : 26815537   Median :114629680  Mean   : 38118599   Mean   :108771467  3rd Qu.: 57496244   3rd Qu.:140278885  Max.   :189248419   Max.   :195014334 ## Use a phenotype that will be used later in the vignette peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           psave   = F) Working in Linux and there are 40 cores in total. NULL ## Chromosome 15 based on the peak location above ## Plot effects peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           chrom = 15,            effects = T,           psave   = F) Working in Linux and there are 40 cores in total. calculating effects NULL start_time <- Sys.time()  thlds <- LOD_thld(mapping = map_peaks$maps_list,                   tissue  = \"liver\",                    n.gene  = 5,                    n.perm  = 500) Working in Linux and there are 40 cores in total. Using 5 phenotypes: UNK_9.634_726.93475_minus  UNK_11.811_1117.70117_minus  TG_18.1_18.1_20.3_1_17.719_926.80585_plus  TG_18.0_18.0_20.4_19.256_933.77148_plus  UNK_1.953_482.35989_plus Running 500 permutations on 5 genes in 1 batches. end_time <- Sys.time()  end_time - start_time Time difference of 3.277559 hours str(thlds) List of 2  $ perms_df: 'scan1perm' num [1:500, 1:5] 6.29 6.49 5.47 6.67 5.3 ...   ..- attr(*, \"dimnames\")=List of 2   .. ..$ : NULL   .. ..$ : chr [1:5] \"UNK_9.634_726.93475_minus\" \"UNK_11.811_1117.70117_minus\" \"TG_18.1_18.1_20.3_1_17.719_926.80585_plus\" \"TG_18.0_18.0_20.4_19.256_933.77148_plus\" ...  $ thlds   :List of 2   ..$ sigLOD : num 7.7   ..$ suggLOD: num 6.3"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"mapping-peak-calling","dir":"Articles","previous_headings":"","what":"Mapping & Peak Calling","title":"Lipidomics Example","text":"following mapping performed passing objects located working environment; paths objects also passed saved individual rds files. Please note - QTLretrievR set work data multiple tissues. means even working single tissue, genoprobs phenotype matrices (expr_mats) need passed list format tissue type. example, normalized lipid counts set lipid phenotypes columns samples rows, transpose count matrix pass mapQTL. counts already rankZ transformed column different phenotype, can specify rz = T submission skip transformation. may notice 16 cores found available Linux system, 8 registered used peak calling. < 1000 phenotypes, found using 8 cores appreciably decrease amount time used peak calling. now briefly look map_peaks object looks like. QTLretrievR returns everything list format separating everything based tissue. Since using liver lipids, tissue liver. using lipid measurements multiple tissues, lists length > 1 named tissue. maps_list peaks_list list element map_peaks$maps_list object list objects different tissues. maps_list preserves following future use either plotting functions, want re-run specific tissue phenotype. qtlprobs: Genotype probabilities (founder allele probabilities) tissue (separated chromosome within tissues, samples x allele x marker) covar_list: Covariate dataframes tissue. Covariates may include sex, diet, age, batch number, etc. expr_list: Copy normalized expression matrices tissue (phenotype x samples) exprZ_list: Copy rankZ transformed expression matrices tissue (samples x phenotype) kinship_loco: Sample kinship matrix tissue, calculated sample genoprobs using leave one chromosome (loco) method (separated chromosome within tissues, samples x samples) gmap: Genetic map markers (centiMorgans cM, separated chromosome) map_dat2: Dataframe markers, genetic physical positions, order markers appear genome. pmap: Physical map markers (basepairs bp, separated chromosome) tissue_samp: Copy sample metadata separated tissue like genetic map distances (cM) rather physical map distances (bp) QTL peaks, can use interp_cM, can use phys = F call mapQTL runQTL. default QTLretrievR return LOD scores < 5; like change threshold, can use thrA thrX autosomes X chromosome, respectively. can also visualize peaks look like overall.  visualize allelic effects occurring specific peak.","code":"## Downsample to 200 liver lipids phenotypes <- sample(colnames(norm_counts), 200, replace = FALSE)  ## Perform QTL Mapping start_time <- Sys.time()  map_peaks <- mapQTL(outdir        = \"../../_data/\",                     peaks_out     = \"liver_lipids_GM_peaks_sub.rds\",                     map_out       = \"liver_lipids_GM_map_sub.rds\",                     genoprobs     = list(\"liver\" = genoprobs),                     samp_meta     = sample_meta,                     expr_mats     = list(\"liver\" = t(norm_counts[,phenotypes])),                     covar_factors = c(\"sex\"),                     gridFile      = gridfile_GM,                     save          = \"ro\") checking probabilities liver gmap complete pmap complete expression loaded Working with 369 samples and 200 genes in liver. rankZ normalized covariates calculated calculating peaks Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). Does that look right? If not please                  set total_cores parameter to the number of available cores. end_time <- Sys.time()  end_time - start_time Time difference of 21.18292 mins names(map_peaks$maps_list) [1] \"qtlprobs\"     \"covar_list\"   \"expr_list\"    \"exprZ_list\"   \"kinship_loco\" [6] \"gmap\"         \"map_dat2\"     \"pmap\"         \"tissue_samp\" str(map_peaks$maps_list$qtlprobs$liver[[1]]) num [1:483, 1:8, 1:9449] 1.26e-03 8.19e-03 8.20e-03 8.20e-03 8.47e-08 ...  - attr(*, \"dimnames\")=List of 3   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ...   ..$ : chr [1:9449] \"UNC6\" \"UNCHS000001\" \"JAX00000010\" \"JAX00000010r\" ... str(map_peaks$maps_list$kinship_loco$liver[[1]]) num [1:483, 1:483] 0.553 0.13 0.149 0.13 0.156 ...  - attr(*, \"n_pos\")= int 114433  - attr(*, \"dimnames\")=List of 2   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ...   ..$ : chr [1:483] \"DO022\" \"DO023\" \"DO024\" \"DO025\" ... str(map_peaks$peaks_list) List of 1  $ liver:'data.frame':  906 obs. of  6 variables:   ..$ phenotype: chr [1:906] \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" \"UNK_10.352_914.61176_minus\" ...   ..$ peak_chr : Factor w/ 20 levels \"1\",\"2\",\"3\",\"4\",..: 5 11 12 15 20 3 5 8 10 11 ...   ..$ peak_bp  : num [1:906] 7.68e+07 6.19e+06 1.19e+07 6.79e+07 1.59e+08 ...   ..$ lod      : num [1:906] 5.85 5.19 5.02 6.86 5.21 ...   ..$ ci_lo    : num [1:906] 72517079 3070782 3082700 65182973 12309718 ...   ..$ ci_hi    : num [1:906] 9.73e+07 1.16e+08 8.70e+07 7.03e+07 1.63e+08 ... summary(map_peaks$peaks_list$liver) phenotype            peak_chr      peak_bp               lod  Length:906         15     : 67   Min.   :  3309356   Min.   : 5.001  Class :character   6      : 59   1st Qu.: 43624520   1st Qu.: 5.239  Mode  :character   18     : 59   Median : 76768036   Median : 5.517                     11     : 57   Mean   : 77905714   Mean   : 5.872                     5      : 56   3rd Qu.:111810346   3rd Qu.: 5.981                     X      : 56   Max.   :193382813   Max.   :28.765                     (Other):552      ci_lo               ci_hi  Min.   :  3050998   Min.   :  6461844  1st Qu.:  9575738   1st Qu.: 83157539  Median : 26815537   Median :114629680  Mean   : 38118599   Mean   :108771467  3rd Qu.: 57496244   3rd Qu.:140278885  Max.   :189248419   Max.   :195014334 ## Use a phenotype that will be used later in the vignette peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           psave   = F) Working in Linux and there are 40 cores in total. NULL ## Chromosome 15 based on the peak location above ## Plot effects peak_plot(mapping = map_peaks$maps_list,           tissue  = \"liver\",           pheno   = \"UNK_17.944_965.82587_plus\",            pop     = \"do\",           chrom = 15,            effects = T,           psave   = F) Working in Linux and there are 40 cores in total. calculating effects NULL"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"lod-thresholding","dir":"Articles","previous_headings":"","what":"LOD Thresholding","title":"Lipidomics Example","text":"calculated peaks, good idea determine significant suggestive LOD thresholds. help us determine phenotypes/QTLs investigate . performing eQTL mapping, can also influence peaks included characterization distal hotspot. , use function LOD_thld; choose 5 lipid phenotypes run 500 permutations , take median values determine significant (alpha = 0.05) suggestive (alpha = 0.4) LOD thresholds. default function use 100 phenotypes run 750 permutations . number appropriate eQTL analyses many thousands gene expression phenotypes, unnecessary ~1500 liver lipids. return permutations object well significant suggestive LODs named list. significant suggestive LOD thresholds 7.697 6.297 respectively, use values mediation analysis haplotype effect identification.","code":"start_time <- Sys.time()  thlds <- LOD_thld(mapping = map_peaks$maps_list,                   tissue  = \"liver\",                    n.gene  = 5,                    n.perm  = 500) Working in Linux and there are 40 cores in total. Using 5 phenotypes: UNK_9.634_726.93475_minus  UNK_11.811_1117.70117_minus  TG_18.1_18.1_20.3_1_17.719_926.80585_plus  TG_18.0_18.0_20.4_19.256_933.77148_plus  UNK_1.953_482.35989_plus Running 500 permutations on 5 genes in 1 batches. end_time <- Sys.time()  end_time - start_time Time difference of 3.277559 hours str(thlds) List of 2  $ perms_df: 'scan1perm' num [1:500, 1:5] 6.29 6.49 5.47 6.67 5.3 ...   ..- attr(*, \"dimnames\")=List of 2   .. ..$ : NULL   .. ..$ : chr [1:5] \"UNK_9.634_726.93475_minus\" \"UNK_11.811_1117.70117_minus\" \"TG_18.1_18.1_20.3_1_17.719_926.80585_plus\" \"TG_18.0_18.0_20.4_19.256_933.77148_plus\" ...  $ thlds   :List of 2   ..$ sigLOD : num 7.7   ..$ suggLOD: num 6.3"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Lipidomics Example","text":"number next steps can taken follow peak identification thresholding. include ascertaining founder strain alleles responsible driving observed QTL effect, performing mediation analysis identify potential causal intermediates responsible conferring QTL.analyses described . can determine founder strain coefficients different QTL peaks. Now, going look peaks mapping across genome identify location multiple phenotypes associated . results 3 phenotypes map position chromosome 15, continue use example rest vignette. unfamiliar Diversity Outbred () mouse population, outbred population derived 8 founder inbred strains represented -H. letter corresponds different founder, order : AJ, B6, 129, NOD, NZO, CAST, PWK, WSB. Chromosome 15 lipid QTL, appears PWK founder allele driving interindividual variation ’re seeing three lipid phenotypes. next step perform mediation analysis (). mediation analysis, want look expressed gene molecular trait (e.g., region open chromatin, methylated region) whose interindividual variation expression/accessibility/etc aligns variation liver lipids seeing given distal QTL peak. Identification “causal intermediates” provide regulator-target hypotheses validation additional experiments. perform mediation analysis transcriptomic data, take gene expression data relevant tissue, liver, re-calculate LOD scores lipid QTL peaks, taking expression candidate mediator gene account additive covariate QTL mapping model. look genes largest LOD drop given phenotype within peak, indicating variation candidate mediator gene best explains distal QTL-driven variation lipid phenotype(s). run mediation, first load mm39-aligned liver expression data, specifically rankZ normalized data. using 3 phenotypes mapping chromosome 15, ’re going look genes within +/- 2Mb identified peak location (82953003) identify gene(s) whose variation expression best explain variation see phenotype. phenotype, identify top 5 mediators plot percent LOD drop heatmap.  plot, appears two predicted genes, predicted lncRNA gene Gm49463 predicted protein coding gene 5031439G07Rik, strong candidate mediators 3 phenotypes, corresponding high percent LOD drop distal lipid QTL peaks. verify , can look dataframe target mediator information, including rank significance. looks like genes first second ranked mediators 3 phenotypes, 5031439G07Rik consistently top ranked significant one.","code":"## Set significant and suggestive thresholds sig_LOD <- thlds$thlds$sigLOD sugg_LOD <- thlds$thlds$suggLOD  ## Calculate Effects eff_out <- qtl_effects(peaks       = map_peaks$peaks_list,                        mapping     = map_peaks$maps_list,                        suggLOD     = sugg_LOD,                         outdir      = \"../../_data/\",                         effects_out = \"liver_lipids_mm39_effects.rds\",                         save        = \"sr\") data checked peaks extracted, calculating effects now Working in Linux and there are 40 cores in total. Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). effects calculated. saving to RDS ## Combine significant peaks with effects peak_effects <- eff_out$peaks$liver |>    left_join(eff_out$effects_blup$liver |>                as.data.frame() |>                rownames_to_column(var = \"marker\"), by = join_by(marker)) ## Identify peaks to use map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD) |>    dplyr::group_by(peak_chr) |>    dplyr::count() # A tibble: 14 × 2 # Groups:   peak_chr [14]    peak_chr     n    <fct>    <int>  1 1            1  2 2            2  3 3            1  4 5            2  5 6            1  6 7            1  7 8            1  8 10           2  9 11           4 10 12           1 11 15          10 12 17           3 13 18           2 14 X            2 map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD, peak_chr == 15) |>    dplyr::arrange(peak_bp) phenotype peak_chr  peak_bp       lod    ci_lo 1                UNK_17.944_965.82587_plus       15 82953003  9.466032 82319925 2  TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 82288820 3  TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826 82319925 4                UNK_18.204_901.80334_plus       15 82977704 13.624220 82277678 5                UNK_16.716_949.80194_plus       15 82977704 12.481903 82288820 6                UNK_16.381_987.81036_plus       15 83968940  9.304922 82406369 7               UNK_16.905_1015.84003_plus       15 83968940 12.324044 82531636 8               UNK_17.448_1011.75751_plus       15 84016072 10.476459 82494131 9              UNK_18.104_1018.88293_minus       15 84085545 16.516295 82288820 10               UNK_14.308_596.59662_plus       15 84374485  8.581107 83950353       ci_hi 1  84576516 2  84576516 3  84576516 4  84576516 5  84576516 6  84576516 7  84576516 8  84576516 9  84374485 10 85513369 ## Set the position of the peak chr15_peak_pos <- 82953003  ## Subset the peak in order to get the features chr15_peak_sub <- map_peaks$peaks_list$liver |>    dplyr::filter(lod      >  sig_LOD,                  peak_chr == 15,                  peak_bp  == chr15_peak_pos)  ## Look at effects for the peaks on chromosome 15 peak_effects |> dplyr::filter(phenotype %in% chr15_peak_sub$phenotype, peak_chr == 15) |>    dplyr::select(phenotype, peak_chr, peak_bp, lod, marker, LETTERS[1:8]) phenotype peak_chr  peak_bp       lod 1               UNK_17.944_965.82587_plus       15 82953003  9.466032 2 TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 3 TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826        marker          A         B         C         D          E          F 1 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655 2 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655 3 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655            G         H 1 -0.8792321 0.1954131 2 -0.8792321 0.1954131 3 -0.8792321 0.1954131 ## Read in the expression data liver_expr <- readRDS(\"../../_data/dataset.liver.GRCm39.v1.rds\")  ## Use the normalized and rankZ transformed gene expression values for mediation liver_rz <- liver_expr$data$rz  ## clean up rm(\"liver_expr\")  ## Run mediation start_time <- Sys.time()  med_out <- multi_modiFinder(peaks   = map_peaks$peaks_list,                              mapping = map_peaks$maps_list,                              exprZ   = liver_rz,                              suggLOD = sugg_LOD,                              annots  = annot_105,                              outdir  = \"../../_data/\",                              med_out = \"liver_lipids_mm39_meds.rds\",                              save    = \"sr\") load annotations checking peaks and mapping data checked Number of common samples for liver: 369 filtered peaks liver running mediation Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). end_time <- Sys.time()  end_time - start_time Time difference of 8.362159 mins chr15_peak_med_rank <- medPlot_single(meds       = med_out$liver,                                       range      = 2,                                       position   = chr15_peak_pos,                                       feats      = chr15_peak_sub$phenotype,                                       chromosome = 15,                                       plot       = \"per_drop\",                                       psave      = F) Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` ## Filter ranked mediation results to candidate mediators chr15_peak_med_rank$meds_ranked |>    dplyr::filter(mediator %in% c(\"Gm49463\", \"5031439G07Rik\")) |>    dplyr::select(target_id, qtl_lod, qtl_chr, mediator, LOD, LOD_drop, padj, per_drop, ranks) # A tibble: 6 × 9   target_id         qtl_lod qtl_chr mediator   LOD LOD_drop  padj per_drop ranks   <chr>               <dbl> <fct>   <chr>    <dbl>    <dbl> <dbl>    <dbl> <dbl> 1 UNK_17.944_965.8…    9.47 15      Gm49463   2.81     6.65     0    0.703     2 2 UNK_17.944_965.8…    9.47 15      5031439…  2.49     6.98     0    0.737     1 3 TG_18.2_18.1_20.…    9.23 15      Gm49463   2.28     6.95     0    0.753     2 4 TG_18.2_18.1_20.…    9.23 15      5031439…  2.17     7.06     0    0.764     1 5 TG_18.1_18.1_22.…   10.0  15      Gm49463   4.67     5.37     0    0.535     2 6 TG_18.1_18.1_22.…   10.0  15      5031439…  4.32     5.73     0    0.570     1"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"founder-strain-effects-at-a-qtl-peak","dir":"Articles","previous_headings":"","what":"Founder Strain Effects at a QTL peak","title":"Lipidomics Example","text":"can determine founder strain coefficients different QTL peaks. Now, going look peaks mapping across genome identify location multiple phenotypes associated . results 3 phenotypes map position chromosome 15, continue use example rest vignette. unfamiliar Diversity Outbred () mouse population, outbred population derived 8 founder inbred strains represented -H. letter corresponds different founder, order : AJ, B6, 129, NOD, NZO, CAST, PWK, WSB. Chromosome 15 lipid QTL, appears PWK founder allele driving interindividual variation ’re seeing three lipid phenotypes. next step perform mediation analysis ().","code":"## Set significant and suggestive thresholds sig_LOD <- thlds$thlds$sigLOD sugg_LOD <- thlds$thlds$suggLOD  ## Calculate Effects eff_out <- qtl_effects(peaks       = map_peaks$peaks_list,                        mapping     = map_peaks$maps_list,                        suggLOD     = sugg_LOD,                         outdir      = \"../../_data/\",                         effects_out = \"liver_lipids_mm39_effects.rds\",                         save        = \"sr\") data checked peaks extracted, calculating effects now Working in Linux and there are 40 cores in total. Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). effects calculated. saving to RDS ## Combine significant peaks with effects peak_effects <- eff_out$peaks$liver |>    left_join(eff_out$effects_blup$liver |>                as.data.frame() |>                rownames_to_column(var = \"marker\"), by = join_by(marker)) ## Identify peaks to use map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD) |>    dplyr::group_by(peak_chr) |>    dplyr::count() # A tibble: 14 × 2 # Groups:   peak_chr [14]    peak_chr     n    <fct>    <int>  1 1            1  2 2            2  3 3            1  4 5            2  5 6            1  6 7            1  7 8            1  8 10           2  9 11           4 10 12           1 11 15          10 12 17           3 13 18           2 14 X            2 map_peaks$peaks_list$liver |>    dplyr::filter(lod > sig_LOD, peak_chr == 15) |>    dplyr::arrange(peak_bp) phenotype peak_chr  peak_bp       lod    ci_lo 1                UNK_17.944_965.82587_plus       15 82953003  9.466032 82319925 2  TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 82288820 3  TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826 82319925 4                UNK_18.204_901.80334_plus       15 82977704 13.624220 82277678 5                UNK_16.716_949.80194_plus       15 82977704 12.481903 82288820 6                UNK_16.381_987.81036_plus       15 83968940  9.304922 82406369 7               UNK_16.905_1015.84003_plus       15 83968940 12.324044 82531636 8               UNK_17.448_1011.75751_plus       15 84016072 10.476459 82494131 9              UNK_18.104_1018.88293_minus       15 84085545 16.516295 82288820 10               UNK_14.308_596.59662_plus       15 84374485  8.581107 83950353       ci_hi 1  84576516 2  84576516 3  84576516 4  84576516 5  84576516 6  84576516 7  84576516 8  84576516 9  84374485 10 85513369 ## Set the position of the peak chr15_peak_pos <- 82953003  ## Subset the peak in order to get the features chr15_peak_sub <- map_peaks$peaks_list$liver |>    dplyr::filter(lod      >  sig_LOD,                  peak_chr == 15,                  peak_bp  == chr15_peak_pos)  ## Look at effects for the peaks on chromosome 15 peak_effects |> dplyr::filter(phenotype %in% chr15_peak_sub$phenotype, peak_chr == 15) |>    dplyr::select(phenotype, peak_chr, peak_bp, lod, marker, LETTERS[1:8]) phenotype peak_chr  peak_bp       lod 1               UNK_17.944_965.82587_plus       15 82953003  9.466032 2 TG_18.2_18.1_20.3_17.162_924.79926_plus       15 82953003  9.229160 3 TG_18.1_18.1_22.4_18.068_952.83057_plus       15 82953003 10.047826        marker          A         B         C         D          E          F 1 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655 2 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655 3 UNC25989251 0.06179844 0.5062979 0.1507993 0.2932129 -0.1734241 -0.1548655            G         H 1 -0.8792321 0.1954131 2 -0.8792321 0.1954131 3 -0.8792321 0.1954131"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/DOAttie500_LiverLipids.html","id":"mediation-analysis","dir":"Articles","previous_headings":"","what":"Mediation Analysis","title":"Lipidomics Example","text":"mediation analysis, want look expressed gene molecular trait (e.g., region open chromatin, methylated region) whose interindividual variation expression/accessibility/etc aligns variation liver lipids seeing given distal QTL peak. Identification “causal intermediates” provide regulator-target hypotheses validation additional experiments. perform mediation analysis transcriptomic data, take gene expression data relevant tissue, liver, re-calculate LOD scores lipid QTL peaks, taking expression candidate mediator gene account additive covariate QTL mapping model. look genes largest LOD drop given phenotype within peak, indicating variation candidate mediator gene best explains distal QTL-driven variation lipid phenotype(s). run mediation, first load mm39-aligned liver expression data, specifically rankZ normalized data. using 3 phenotypes mapping chromosome 15, ’re going look genes within +/- 2Mb identified peak location (82953003) identify gene(s) whose variation expression best explain variation see phenotype. phenotype, identify top 5 mediators plot percent LOD drop heatmap.  plot, appears two predicted genes, predicted lncRNA gene Gm49463 predicted protein coding gene 5031439G07Rik, strong candidate mediators 3 phenotypes, corresponding high percent LOD drop distal lipid QTL peaks. verify , can look dataframe target mediator information, including rank significance. looks like genes first second ranked mediators 3 phenotypes, 5031439G07Rik consistently top ranked significant one.","code":"## Read in the expression data liver_expr <- readRDS(\"../../_data/dataset.liver.GRCm39.v1.rds\")  ## Use the normalized and rankZ transformed gene expression values for mediation liver_rz <- liver_expr$data$rz  ## clean up rm(\"liver_expr\")  ## Run mediation start_time <- Sys.time()  med_out <- multi_modiFinder(peaks   = map_peaks$peaks_list,                              mapping = map_peaks$maps_list,                              exprZ   = liver_rz,                              suggLOD = sugg_LOD,                              annots  = annot_105,                              outdir  = \"../../_data/\",                              med_out = \"liver_lipids_mm39_meds.rds\",                              save    = \"sr\") load annotations checking peaks and mapping data checked Number of common samples for liver: 369 filtered peaks liver running mediation Working in Linux and there are 40 cores in total. Registering 8 cores and passing 8 cores per tissue to 1 tissue(s). end_time <- Sys.time()  end_time - start_time Time difference of 8.362159 mins chr15_peak_med_rank <- medPlot_single(meds       = med_out$liver,                                       range      = 2,                                       position   = chr15_peak_pos,                                       feats      = chr15_peak_sub$phenotype,                                       chromosome = 15,                                       plot       = \"per_drop\",                                       psave      = F) Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` Joining with `by = join_by(target_id, qtl_lod, qtl_chr, mediator, mediator_id, mediator_chr, mediator_midpoint, LOD, LOD_drop)` ## Filter ranked mediation results to candidate mediators chr15_peak_med_rank$meds_ranked |>    dplyr::filter(mediator %in% c(\"Gm49463\", \"5031439G07Rik\")) |>    dplyr::select(target_id, qtl_lod, qtl_chr, mediator, LOD, LOD_drop, padj, per_drop, ranks) # A tibble: 6 × 9   target_id         qtl_lod qtl_chr mediator   LOD LOD_drop  padj per_drop ranks   <chr>               <dbl> <fct>   <chr>    <dbl>    <dbl> <dbl>    <dbl> <dbl> 1 UNK_17.944_965.8…    9.47 15      Gm49463   2.81     6.65     0    0.703     2 2 UNK_17.944_965.8…    9.47 15      5031439…  2.49     6.98     0    0.737     1 3 TG_18.2_18.1_20.…    9.23 15      Gm49463   2.28     6.95     0    0.753     2 4 TG_18.2_18.1_20.…    9.23 15      5031439…  2.17     7.06     0    0.764     1 5 TG_18.1_18.1_22.…   10.0  15      Gm49463   4.67     5.37     0    0.535     2 6 TG_18.1_18.1_22.…   10.0  15      5031439…  4.32     5.73     0    0.570     1"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick start","title":"QTL Identification and Analysis with QTLretrievR","text":"easiest way run QTLretrievR. several input files required runQTL described detail . function return list objects used QTL mapping, annotated QTL peaks, QTL effects, mediation results. Note example objects returned, saved. wish objects saved later use can change save “” (save ), “sr” (save return). can alternatively submitted follows: returns mapping object, original peaks object, mediation object, effects object. peaks, effects mediation objects can used additional plotting analysis.","code":"## Passing a Genoprobs object - list of probabilities for each tissue ## Using internal data for expr, gridFile, metadata, annots ## Unevaluated Code Chunk  qtl_res <- runQTL(outdir = \"../../vignette/\",                    gbrs_fileLoc = list(\"mESC\" = demo_probs),                   geno_out = \"mESC_mm10_probs.rds\",                    peaks_out = \"mESC_mm10_peaks.rds\",                    map_out = \"mESC_mm10_map.rds\",                    med_out = \"mESC_mm10_mediation.rds\",                   effects_out = \"mESC_mm10_effects.rds\",                   expr_mats = list(\"mESC\" = demo_counts),                   tissues = \"mESC\",                    gridFile = gridfile69k,                    covar_factors = c(\"sex\"),                   metadata = demo_meta,                    annots = demo_annot,                    save_t = \"ro\") ## Unevaluated Code Chunk  qtl_res <- runQTL(outdir = <path/to/output/dir>,                    gbrs_fileLoc = <path/to/gbrs/files>,                   geno_out = \"Name_for_genotype_prob_file.rds\",                    peaks_out = \"Name_for_QTL_peaks.rds\",                    map_out = \"Name_for_mapping_objects.rds\",                    med_out = \"Name_for_mediation_Results.rds\",                   effects_out = \"Name_for_QTL_effects.rds\",                   expr_mats = c(<path/to/expr_mat1>, <path/to/expr_mat2>),                   tissues = \"Tissue_name\",                   gridFile = <path/to/gridfile>,                    covar_factors = c(\"Covariates\"),                   metadata = <path/to/sample/metadata>,                    annots = <path/to/annotations>,                    save = \"ro\"                   )"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"inputs-data","dir":"Articles","previous_headings":"","what":"Inputs Data","title":"QTL Identification and Analysis with QTLretrievR","text":"several types data QTLretrievR takes input, describe variations required optional data inputs.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"genotype-probabilities","dir":"Articles","previous_headings":"Inputs Data","what":"Genotype Probabilities","title":"QTL Identification and Analysis with QTLretrievR","text":"Genotype Probabilities (genoprobs) can passed QTLretreivR different ways. Passed string location .tsv probability files GBRS software. can folder GBRS results kept, files end .gbrs.interpolated.genoprobs.tsv. option used genoprobably runQTL. probably easiest option starting scratch GBRS genotypes. Passed two dimensional array genotype probabilities samples. See genotype_probs.Rds file example look. option passing runQTL. Passed qtl2 formatted genoprobs object. option passing runQTL mapQTL. example shown . genotyping one Mouse Universal Genotyping Arrays (MUGA), can format probabilities using mugaprobs function, detailed example Genoprobs section document.","code":"## Structure and example of qtl2 fomatted genoprobs names(demo_probs) #>  [1] \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\" \"14\" \"15\" #> [16] \"16\" \"17\" \"18\" \"19\" \"X\" str(demo_probs[[1]]) #>  num [1:10, 1:8, 1:4711] 1.48e-08 1.23e-08 1.04e-08 3.31e-08 2.94e-07 ... #>  - attr(*, \"dimnames\")=List of 3 #>   ..$ : chr [1:10] \"PB357.02_repA\" \"PB357.12_repA\" \"PB357.16_repA\" \"PB357.18_repA\" ... #>   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ... #>   ..$ : chr [1:4711] \"1_3000000\" \"1_3041392\" \"1_3346528\" \"1_3651663\" ... demo_probs[[1]][1:2,,1:2] #> , , 1_3000000 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08 #>  #> , , 1_3041392 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"quantified-phenotypes","dir":"Articles","previous_headings":"Inputs Data","what":"Quantified Phenotypes","title":"QTL Identification and Analysis with QTLretrievR","text":"Although variable named expr_mats quantified molecular data can passed variable. can passed vector paths data (order tissues passed), named list matrices (named tissue type associated counts). filtered, batch corrected normalized data phenotype rows samples columns, need rankZ transform counts, step occurs mapQTL. See attached demo_counts example formatting.","code":"## Information and partial example of quantified data class(demo_counts) #> [1] \"matrix\" \"array\" head(demo_counts) #>                    PB357.02_repA PB357.12_repA PB357.16_repA PB357.18_repA #> ENSMUSG00000030402      90.27620      47.49881      65.92215      60.68472 #> ENSMUSG00000025473      55.33058      61.24847      59.68627      26.61611 #> ENSMUSG00000029246    2333.74400    5135.62454    2341.10901    2701.05069 #> ENSMUSG00000051413     218.41017     162.49593     209.34736     223.57530 #> ENSMUSG00000026356    3244.11907   11302.21694    2892.56671    4801.55973 #> ENSMUSG00000042505     317.42278     554.98610     316.24815     300.22969 #>                    PB357.19_repA PB357.20_repA PB357.21_repA PB357.22_repA #> ENSMUSG00000030402       50.6948      43.98085      68.98128      57.27735 #> ENSMUSG00000025473       24.3725      45.02802      55.41119      37.55891 #> ENSMUSG00000029246     3481.3853    2611.54250    1373.65252    3451.91477 #> ENSMUSG00000051413      230.0764     158.12164     211.46720     217.84171 #> ENSMUSG00000026356     5616.3992    4653.59323    2312.56906    5754.02576 #> ENSMUSG00000042505      348.0393     347.65818     360.73816     294.83748 #>                    PB357.28_repA PB357.29_repA #> ENSMUSG00000030402      42.11575      52.36949 #> ENSMUSG00000025473      14.03858      44.38093 #> ENSMUSG00000029246    3130.74325    2534.28661 #> ENSMUSG00000051413     161.91166     260.95984 #> ENSMUSG00000026356    6941.61141    4452.29448 #> ENSMUSG00000042505     440.81151     286.70078"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"marker-grid","dir":"Articles","previous_headings":"Inputs Data","what":"Marker Grid","title":"QTL Identification and Analysis with QTLretrievR","text":"grid markers associated genomic locations bp cM. grid file can passed object, path file located. two grid files attached QTLretrievR, grid ~75K pseudo-markers positions updated mm38 grid ~69K pseudo-markers positions associated mm10, GigaMUGA MegaMUGA markers positions. can use new marker grid used probabilities. making grid file, see gridfile make sure correct format.","code":"## example format for 75K marker grid head(gridfile) #>           chr     pos      cM #> 1_3000000   1 3000000 0.00001 #> 1_3039563   1 3039563 0.02001 #> 1_3079126   1 3079126 0.04001 #> 1_3118689   1 3118689 0.06001 #> 1_3158252   1 3158252 0.08001 #> 1_3197814   1 3197814 0.10001"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"metadata","dir":"Articles","previous_headings":"Inputs Data","what":"Metadata","title":"QTL Identification and Analysis with QTLretrievR","text":"minimum, metadata file contain column sample IDs (ID) columns covariates included peak effect calling. pieces information may relevant analysis want make sure place also included. minimal example, demo_meta, attached QTLretrievR.","code":"## minimal metadata example head(demo_meta[which(demo_meta$ID %in% colnames(demo_counts)),]) #>              ID sex #> 1 PB357.02_repA   F #> 2 PB357.12_repA   F #> 3 PB357.16_repA   F #> 4 PB357.18_repA   F #> 5 PB357.19_repA   F #> 6 PB357.20_repA   F"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"annotations","dir":"Articles","previous_headings":"Inputs Data","what":"Annotations","title":"QTL Identification and Analysis with QTLretrievR","text":"Currently annotations needs contain minimum id, symbol, chr, start, end columns. id column contain phenotype information appears row names quantified data. attached example (demo_annot) id column contains ensembl gene IDs, traded ensembl protein IDs phenotype identifier. demo_annot file Ensemblv84 biomart annotations, using newer expression data use annot_105 upload annotations","code":"## Example annotation file - Note this file is all the genes for the Ensemblv84 build head(demo_annot) #>                   id symbol chr     start       end #> 1 ENSMUSG00000000001  Gnai3   3 108107280 108146146 #> 2 ENSMUSG00000000028  Cdc45  16  18780447  18811987 #> 3 ENSMUSG00000000031    H19   7 142575529 142578143 #> 4 ENSMUSG00000000037  Scml2   X 161117193 161258213 #> 5 ENSMUSG00000000056   Narf  11 121237253 121255856 #> 6 ENSMUSG00000000058   Cav2   6  17281185  17289115"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"running-as-separate-steps","dir":"Articles","previous_headings":"","what":"Running as Separate Steps","title":"QTL Identification and Analysis with QTLretrievR","text":", instead using wrapper run steps , wish run step individually (calculating/formatting genotype probabilities, mapping/peak calling, mediation, effects) can done relative ease.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"genoprobs","dir":"Articles","previous_headings":"Running as Separate Steps","what":"Genoprobs","title":"QTL Identification and Analysis with QTLretrievR","text":"order convert genoprobs GBRS output qtl2 format run function called genoprobably. pulls relevant files provided location splits samples tissues derived (names pass tissue included file name form), puts 3 dimensional format based markers. genotype probabilities 3D format probs_3d_to_qtl2 used convert qtl2 format. example shows run genoprobably 75k gridfile. Alternatively can use genotyping either GigaMUGA MegaMUGA genome probabilities. order convert reports qtl2 format run function called mugaprobs. loads appropriate grid files, builds control file, processes genotyping file(s) correct allele based format processing. example shows run mugaprobs sample GigaMUGA genotyping run.","code":"## Unevaluated Code Chunk probs <- genoprobably(outfile     = \"../../vignette/gbrs_interpolated_probs.rds\",                        gbrsFileLoc = \"<path/to/gbrs/results>\",                       tissues     = c(\"tissue1\",\"tissue2\"),                        gridFile    = gridfile,                        save        = \"ro\") ## Unevaluated Code Chunk  probs <- mugaprobs(type       = \"GM\",                                   # Did your genotyping come from GigaMUGA or MegaMUGA?                    covarLoc   = \"/path/to/covariate/file/\",                     covar_file = \"name_of_covariate_file.tsv\",                     i.files    = c(\"final_report_1\", \"final_report_2\"),  # If you already have chromosome specific genotype files you can pass that directory as a string here                    genoPrefix = \"gm4qtl2\",                     probsOut   = \"muga_interpolated_genoprobs.rds\",      # This is the file that your probabilites will be saved to                    tissues    = c(\"tissue1\", \"tissue2\"))                # All probabilities will be attributed to each tissue, this is just to put it in the format needed for `mapQTL`"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"mapping-and-peak-calling","dir":"Articles","previous_headings":"Running as Separate Steps","what":"Mapping and Peak Calling","title":"QTL Identification and Analysis with QTLretrievR","text":"mapping peak calling steps combined pipeline. use genoprobs calculate kinship, create genetic pysical maps. using quantified data sample metadata rankZ normalize counts, calculate covariates finally peak calling using qtl2::scan1.","code":"## Unevaluated Code Chunk ## Passing objects: map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = probs,                      samp_meta     = demo_meta,                   # Make sure that your ID column is named \"ID\"                     expr_mats     = list(\"mESC\" = demo_counts),  # Pass your counts as a named list                     covar_factors = c(\"sex\"),                     gridFile      = gridfile,                      annots        = demo_annot,                  # See the Annotations section above for notes on this                     save          = \"ro\")                        # return only - other options are \"so\" (save only) and \"sr\" (save and return)  ## Passing file locations map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = \"path/to/saved/probs.rds\",                     samp_meta     = \"path/to/sample/metadata\",                     expr_mats     = c(\"path/to/counts1\",\"path/to/coounts/2\"),                      covar_factors = c(\"sex\"),                     gridFile      = \"path/to/custom/grid\",                     annots        = \"path/to/annotations\",                     save          = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"mediation","dir":"Articles","previous_headings":"Running as Separate Steps","what":"Mediation","title":"QTL Identification and Analysis with QTLretrievR","text":"mediation use peaks, mapping information (includes rankZ normalized counts), annotations identify targets turn allows us identify phenotypes act mediators peaks suggestive LOD. done using intermediate::mediation.scan.","code":"## Unevaluated Code Chunk med_res <- run_mediate(peaks   = map_peaks$peaks_list,                         mapping = map_peaks$maps_list,                        outdir  = \"../../vignette\",                         annots  = demo_annot,                        suggLOD = 7,                         med_out = \"mm39_mediation.rds\",                         save    = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"effects","dir":"Articles","previous_headings":"Running as Separate Steps","what":"Effects","title":"QTL Identification and Analysis with QTLretrievR","text":"identify founder effects peaks interest, use peaks, mapping information along suggestive LOD threshold ensure reported effects relevant peaks . done using qtl2::scan1blup.","code":"## Unevaluated Code Chunk effects <- qtl_effects(mapping = map_peaks$maps_list,                         peaks   = map_peaks$peaks_list,                        suggLOD = 7,                         outdir  = \"../../vignette\",                         outfile = \"mm39_effects.rds\",                         save    = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR.html","id":"submitting-to-a-job-scheduler","dir":"Articles","previous_headings":"","what":"Submitting to a Job Scheduler","title":"QTL Identification and Analysis with QTLretrievR","text":"Currently, QTLretrievR set identify available cores linux, mac, windows environment. also able identify number cores submitting job SLURM scheduler. Just make sure include following lines SBATCH: number cores calculated parallelization purposes, total number cores identified N*X. don’t include , submitting SLURM scheduler, may identify correct number cores. using scheduler, make sure specify total number cpus whole job. applicable number processes 1.","code":"#SBATCH --ntasks=N #SBATCH --cpus-per-task=X"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Quick start","title":null,"text":"easiest way run QTLretrievR. several input files required runQTL described detail . function return list objects used QTL mapping, annotated QTL peaks, QTL effects, mediation results. Note example objects returned, saved. wish objects saved later use can change save “” (save ), “sr” (save return). can alternatively submitted follows: returns mapping object, original peaks object, mediation object, effects object. peaks, effects mediation objects can used additional plotting analysis.","code":"## Passing a Genoprobs object - list of probabilities for each tissue ## Using internal data for expr, gridFile, metadata, annots ## Unevaluated Code Chunk  qtl_res <- runQTL(outdir = \"../../vignette/\",                    gbrs_fileLoc = list(\"mESC\" = demo_probs),                   geno_out = \"mESC_mm10_probs.rds\",                    peaks_out = \"mESC_mm10_peaks.rds\",                    map_out = \"mESC_mm10_map.rds\",                    med_out = \"mESC_mm10_mediation.rds\",                   effects_out = \"mESC_mm10_effects.rds\",                   expr_mats = list(\"mESC\" = demo_counts),                   tissues = \"mESC\",                    gridFile = gridfile69k,                    covar_factors = c(\"sex\"),                   metadata = demo_meta,                    annots = demo_annot,                    save_t = \"ro\") ## Unevaluated Code Chunk  qtl_res <- runQTL(outdir = <path/to/output/dir>,                    gbrs_fileLoc = <path/to/gbrs/files>,                   geno_out = \"Name_for_genotype_prob_file.rds\",                    peaks_out = \"Name_for_QTL_peaks.rds\",                    map_out = \"Name_for_mapping_objects.rds\",                    med_out = \"Name_for_mediation_Results.rds\",                   effects_out = \"Name_for_QTL_effects.rds\",                   expr_mats = c(<path/to/expr_mat1>, <path/to/expr_mat2>),                   tissues = \"Tissue_name\",                   gridFile = <path/to/gridfile>,                    covar_factors = c(\"Covariates\"),                   metadata = <path/to/sample/metadata>,                    annots = <path/to/annotations>,                    save = \"ro\"                   )"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Inputs Data","title":null,"text":"several types data QTLretrievR takes input, describe variations required optional data inputs. Genotype Probabilities (genoprobs) can passed QTLretreivR different ways. Passed string location .tsv probability files GBRS software. can folder GBRS results kept, files end .gbrs.interpolated.genoprobs.tsv. option used genoprobably runQTL. probably easiest option starting scratch GBRS genotypes. Passed two dimensional array genotype probabilities samples. See genotype_probs.Rds file example look. option passing runQTL. Passed qtl2 formatted genoprobs object. option passing runQTL mapQTL. example shown . genotyping one Mouse Universal Genotyping Arrays (MUGA), can format probabilities using mugaprobs function, detailed example Genoprobs section document. Although variable named expr_mats quantified molecular data can passed variable. can passed vector paths data (order tissues passed), named list matrices (named tissue type associated counts). filtered, batch corrected normalized data phenotype rows samples columns, need rankZ transform counts, step occurs mapQTL. See attached demo_counts example formatting. grid markers associated genomic locations bp cM. grid file can passed object, path file located. two grid files attached QTLretrievR, grid ~75K pseudo-markers positions updated mm38 grid ~69K pseudo-markers positions associated mm10, GigaMUGA MegaMUGA markers positions. can use new marker grid used probabilities. making grid file, see gridfile make sure correct format. minimum, metadata file contain column sample IDs (ID) columns covariates included peak effect calling. pieces information may relevant analysis want make sure place also included. minimal example, demo_meta, attached QTLretrievR. Currently annotations needs contain minimum id, symbol, chr, start, end columns. id column contain phenotype information appears row names quantified data. attached example (demo_annot) id column contains ensembl gene IDs, traded ensembl protein IDs phenotype identifier. demo_annot file Ensemblv84 biomart annotations, using newer expression data use annot_105 upload annotations","code":"## Structure and example of qtl2 fomatted genoprobs names(demo_probs) #>  [1] \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\" \"14\" \"15\" #> [16] \"16\" \"17\" \"18\" \"19\" \"X\" str(demo_probs[[1]]) #>  num [1:10, 1:8, 1:4711] 1.48e-08 1.23e-08 1.04e-08 3.31e-08 2.94e-07 ... #>  - attr(*, \"dimnames\")=List of 3 #>   ..$ : chr [1:10] \"PB357.02_repA\" \"PB357.12_repA\" \"PB357.16_repA\" \"PB357.18_repA\" ... #>   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ... #>   ..$ : chr [1:4711] \"1_3000000\" \"1_3041392\" \"1_3346528\" \"1_3651663\" ... demo_probs[[1]][1:2,,1:2] #> , , 1_3000000 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08 #>  #> , , 1_3041392 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08 ## Information and partial example of quantified data class(demo_counts) #> [1] \"matrix\" \"array\" head(demo_counts) #>                    PB357.02_repA PB357.12_repA PB357.16_repA PB357.18_repA #> ENSMUSG00000030402      90.27620      47.49881      65.92215      60.68472 #> ENSMUSG00000025473      55.33058      61.24847      59.68627      26.61611 #> ENSMUSG00000029246    2333.74400    5135.62454    2341.10901    2701.05069 #> ENSMUSG00000051413     218.41017     162.49593     209.34736     223.57530 #> ENSMUSG00000026356    3244.11907   11302.21694    2892.56671    4801.55973 #> ENSMUSG00000042505     317.42278     554.98610     316.24815     300.22969 #>                    PB357.19_repA PB357.20_repA PB357.21_repA PB357.22_repA #> ENSMUSG00000030402       50.6948      43.98085      68.98128      57.27735 #> ENSMUSG00000025473       24.3725      45.02802      55.41119      37.55891 #> ENSMUSG00000029246     3481.3853    2611.54250    1373.65252    3451.91477 #> ENSMUSG00000051413      230.0764     158.12164     211.46720     217.84171 #> ENSMUSG00000026356     5616.3992    4653.59323    2312.56906    5754.02576 #> ENSMUSG00000042505      348.0393     347.65818     360.73816     294.83748 #>                    PB357.28_repA PB357.29_repA #> ENSMUSG00000030402      42.11575      52.36949 #> ENSMUSG00000025473      14.03858      44.38093 #> ENSMUSG00000029246    3130.74325    2534.28661 #> ENSMUSG00000051413     161.91166     260.95984 #> ENSMUSG00000026356    6941.61141    4452.29448 #> ENSMUSG00000042505     440.81151     286.70078 ## example format for 75K marker grid head(gridfile) #>           chr     pos      cM #> 1_3000000   1 3000000 0.00001 #> 1_3039563   1 3039563 0.02001 #> 1_3079126   1 3079126 0.04001 #> 1_3118689   1 3118689 0.06001 #> 1_3158252   1 3158252 0.08001 #> 1_3197814   1 3197814 0.10001 ## minimal metadata example head(demo_meta[which(demo_meta$ID %in% colnames(demo_counts)),]) #>              ID sex #> 1 PB357.02_repA   F #> 2 PB357.12_repA   F #> 3 PB357.16_repA   F #> 4 PB357.18_repA   F #> 5 PB357.19_repA   F #> 6 PB357.20_repA   F ## Example annotation file - Note this file is all the genes for the Ensemblv84 build head(demo_annot) #>                   id symbol chr     start       end #> 1 ENSMUSG00000000001  Gnai3   3 108107280 108146146 #> 2 ENSMUSG00000000028  Cdc45  16  18780447  18811987 #> 3 ENSMUSG00000000031    H19   7 142575529 142578143 #> 4 ENSMUSG00000000037  Scml2   X 161117193 161258213 #> 5 ENSMUSG00000000056   Narf  11 121237253 121255856 #> 6 ENSMUSG00000000058   Cav2   6  17281185  17289115"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Genotype Probabilities","title":null,"text":"Genotype Probabilities (genoprobs) can passed QTLretreivR different ways. Passed string location .tsv probability files GBRS software. can folder GBRS results kept, files end .gbrs.interpolated.genoprobs.tsv. option used genoprobably runQTL. probably easiest option starting scratch GBRS genotypes. Passed two dimensional array genotype probabilities samples. See genotype_probs.Rds file example look. option passing runQTL. Passed qtl2 formatted genoprobs object. option passing runQTL mapQTL. example shown . genotyping one Mouse Universal Genotyping Arrays (MUGA), can format probabilities using mugaprobs function, detailed example Genoprobs section document.","code":"## Structure and example of qtl2 fomatted genoprobs names(demo_probs) #>  [1] \"1\"  \"2\"  \"3\"  \"4\"  \"5\"  \"6\"  \"7\"  \"8\"  \"9\"  \"10\" \"11\" \"12\" \"13\" \"14\" \"15\" #> [16] \"16\" \"17\" \"18\" \"19\" \"X\" str(demo_probs[[1]]) #>  num [1:10, 1:8, 1:4711] 1.48e-08 1.23e-08 1.04e-08 3.31e-08 2.94e-07 ... #>  - attr(*, \"dimnames\")=List of 3 #>   ..$ : chr [1:10] \"PB357.02_repA\" \"PB357.12_repA\" \"PB357.16_repA\" \"PB357.18_repA\" ... #>   ..$ : chr [1:8] \"A\" \"B\" \"C\" \"D\" ... #>   ..$ : chr [1:4711] \"1_3000000\" \"1_3041392\" \"1_3346528\" \"1_3651663\" ... demo_probs[[1]][1:2,,1:2] #> , , 1_3000000 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08 #>  #> , , 1_3041392 #>  #>                          A   B            C            D            E #> PB357.02_repA 1.477899e-08 0.5 1.217364e-08 1.370868e-08 1.199720e-08 #> PB357.12_repA 1.232415e-08 0.5 5.000000e-01 1.604246e-08 3.499095e-09 #>                          F            G            H #> PB357.02_repA 5.000000e-01 4.331041e-09 1.313560e-08 #> PB357.12_repA 1.478095e-08 4.742920e-09 1.118048e-08"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Quantified Phenotypes","title":null,"text":"Although variable named expr_mats quantified molecular data can passed variable. can passed vector paths data (order tissues passed), named list matrices (named tissue type associated counts). filtered, batch corrected normalized data phenotype rows samples columns, need rankZ transform counts, step occurs mapQTL. See attached demo_counts example formatting.","code":"## Information and partial example of quantified data class(demo_counts) #> [1] \"matrix\" \"array\" head(demo_counts) #>                    PB357.02_repA PB357.12_repA PB357.16_repA PB357.18_repA #> ENSMUSG00000030402      90.27620      47.49881      65.92215      60.68472 #> ENSMUSG00000025473      55.33058      61.24847      59.68627      26.61611 #> ENSMUSG00000029246    2333.74400    5135.62454    2341.10901    2701.05069 #> ENSMUSG00000051413     218.41017     162.49593     209.34736     223.57530 #> ENSMUSG00000026356    3244.11907   11302.21694    2892.56671    4801.55973 #> ENSMUSG00000042505     317.42278     554.98610     316.24815     300.22969 #>                    PB357.19_repA PB357.20_repA PB357.21_repA PB357.22_repA #> ENSMUSG00000030402       50.6948      43.98085      68.98128      57.27735 #> ENSMUSG00000025473       24.3725      45.02802      55.41119      37.55891 #> ENSMUSG00000029246     3481.3853    2611.54250    1373.65252    3451.91477 #> ENSMUSG00000051413      230.0764     158.12164     211.46720     217.84171 #> ENSMUSG00000026356     5616.3992    4653.59323    2312.56906    5754.02576 #> ENSMUSG00000042505      348.0393     347.65818     360.73816     294.83748 #>                    PB357.28_repA PB357.29_repA #> ENSMUSG00000030402      42.11575      52.36949 #> ENSMUSG00000025473      14.03858      44.38093 #> ENSMUSG00000029246    3130.74325    2534.28661 #> ENSMUSG00000051413     161.91166     260.95984 #> ENSMUSG00000026356    6941.61141    4452.29448 #> ENSMUSG00000042505     440.81151     286.70078"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Marker Grid","title":null,"text":"grid markers associated genomic locations bp cM. grid file can passed object, path file located. two grid files attached QTLretrievR, grid ~75K pseudo-markers positions updated mm38 grid ~69K pseudo-markers positions associated mm10, GigaMUGA MegaMUGA markers positions. can use new marker grid used probabilities. making grid file, see gridfile make sure correct format.","code":"## example format for 75K marker grid head(gridfile) #>           chr     pos      cM #> 1_3000000   1 3000000 0.00001 #> 1_3039563   1 3039563 0.02001 #> 1_3079126   1 3079126 0.04001 #> 1_3118689   1 3118689 0.06001 #> 1_3158252   1 3158252 0.08001 #> 1_3197814   1 3197814 0.10001"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Metadata","title":null,"text":"minimum, metadata file contain column sample IDs (ID) columns covariates included peak effect calling. pieces information may relevant analysis want make sure place also included. minimal example, demo_meta, attached QTLretrievR.","code":"## minimal metadata example head(demo_meta[which(demo_meta$ID %in% colnames(demo_counts)),]) #>              ID sex #> 1 PB357.02_repA   F #> 2 PB357.12_repA   F #> 3 PB357.16_repA   F #> 4 PB357.18_repA   F #> 5 PB357.19_repA   F #> 6 PB357.20_repA   F"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Annotations","title":null,"text":"Currently annotations needs contain minimum id, symbol, chr, start, end columns. id column contain phenotype information appears row names quantified data. attached example (demo_annot) id column contains ensembl gene IDs, traded ensembl protein IDs phenotype identifier. demo_annot file Ensemblv84 biomart annotations, using newer expression data use annot_105 upload annotations","code":"## Example annotation file - Note this file is all the genes for the Ensemblv84 build head(demo_annot) #>                   id symbol chr     start       end #> 1 ENSMUSG00000000001  Gnai3   3 108107280 108146146 #> 2 ENSMUSG00000000028  Cdc45  16  18780447  18811987 #> 3 ENSMUSG00000000031    H19   7 142575529 142578143 #> 4 ENSMUSG00000000037  Scml2   X 161117193 161258213 #> 5 ENSMUSG00000000056   Narf  11 121237253 121255856 #> 6 ENSMUSG00000000058   Cav2   6  17281185  17289115"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Running as Separate Steps","title":null,"text":", instead using wrapper run steps , wish run step individually (calculating/formatting genotype probabilities, mapping/peak calling, mediation, effects) can done relative ease. order convert genoprobs GBRS output qtl2 format run function called genoprobably. pulls relevant files provided location splits samples tissues derived (names pass tissue included file name form), puts 3 dimensional format based markers. genotype probabilities 3D format probs_3d_to_qtl2 used convert qtl2 format. example shows run genoprobably 75k gridfile. Alternatively can use genotyping either GigaMUGA MegaMUGA genome probabilities. order convert reports qtl2 format run function called mugaprobs. loads appropriate grid files, builds control file, processes genotyping file(s) correct allele based format processing. example shows run mugaprobs sample GigaMUGA genotyping run. mapping peak calling steps combined pipeline. use genoprobs calculate kinship, create genetic pysical maps. using quantified data sample metadata rankZ normalize counts, calculate covariates finally peak calling using qtl2::scan1. mediation use peaks, mapping information (includes rankZ normalized counts), annotations identify targets turn allows us identify phenotypes act mediators peaks suggestive LOD. done using intermediate::mediation.scan. identify founder effects peaks interest, use peaks, mapping information along suggestive LOD threshold ensure reported effects relevant peaks . done using qtl2::scan1blup.","code":"## Unevaluated Code Chunk probs <- genoprobably(outfile     = \"../../vignette/gbrs_interpolated_probs.rds\",                        gbrsFileLoc = \"<path/to/gbrs/results>\",                       tissues     = c(\"tissue1\",\"tissue2\"),                        gridFile    = gridfile,                        save        = \"ro\") ## Unevaluated Code Chunk  probs <- mugaprobs(type       = \"GM\",                                   # Did your genotyping come from GigaMUGA or MegaMUGA?                    covarLoc   = \"/path/to/covariate/file/\",                     covar_file = \"name_of_covariate_file.tsv\",                     i.files    = c(\"final_report_1\", \"final_report_2\"),  # If you already have chromosome specific genotype files you can pass that directory as a string here                    genoPrefix = \"gm4qtl2\",                     probsOut   = \"muga_interpolated_genoprobs.rds\",      # This is the file that your probabilites will be saved to                    tissues    = c(\"tissue1\", \"tissue2\"))                # All probabilities will be attributed to each tissue, this is just to put it in the format needed for `mapQTL` ## Unevaluated Code Chunk ## Passing objects: map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = probs,                      samp_meta     = demo_meta,                   # Make sure that your ID column is named \"ID\"                     expr_mats     = list(\"mESC\" = demo_counts),  # Pass your counts as a named list                     covar_factors = c(\"sex\"),                     gridFile      = gridfile,                      annots        = demo_annot,                  # See the Annotations section above for notes on this                     save          = \"ro\")                        # return only - other options are \"so\" (save only) and \"sr\" (save and return)  ## Passing file locations map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = \"path/to/saved/probs.rds\",                     samp_meta     = \"path/to/sample/metadata\",                     expr_mats     = c(\"path/to/counts1\",\"path/to/coounts/2\"),                      covar_factors = c(\"sex\"),                     gridFile      = \"path/to/custom/grid\",                     annots        = \"path/to/annotations\",                     save          = \"ro\") ## Unevaluated Code Chunk med_res <- run_mediate(peaks   = map_peaks$peaks_list,                         mapping = map_peaks$maps_list,                        outdir  = \"../../vignette\",                         annots  = demo_annot,                        suggLOD = 7,                         med_out = \"mm39_mediation.rds\",                         save    = \"ro\") ## Unevaluated Code Chunk effects <- qtl_effects(mapping = map_peaks$maps_list,                         peaks   = map_peaks$peaks_list,                        suggLOD = 7,                         outdir  = \"../../vignette\",                         outfile = \"mm39_effects.rds\",                         save    = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Genoprobs","title":null,"text":"order convert genoprobs GBRS output qtl2 format run function called genoprobably. pulls relevant files provided location splits samples tissues derived (names pass tissue included file name form), puts 3 dimensional format based markers. genotype probabilities 3D format probs_3d_to_qtl2 used convert qtl2 format. example shows run genoprobably 75k gridfile. Alternatively can use genotyping either GigaMUGA MegaMUGA genome probabilities. order convert reports qtl2 format run function called mugaprobs. loads appropriate grid files, builds control file, processes genotyping file(s) correct allele based format processing. example shows run mugaprobs sample GigaMUGA genotyping run.","code":"## Unevaluated Code Chunk probs <- genoprobably(outfile     = \"../../vignette/gbrs_interpolated_probs.rds\",                        gbrsFileLoc = \"<path/to/gbrs/results>\",                       tissues     = c(\"tissue1\",\"tissue2\"),                        gridFile    = gridfile,                        save        = \"ro\") ## Unevaluated Code Chunk  probs <- mugaprobs(type       = \"GM\",                                   # Did your genotyping come from GigaMUGA or MegaMUGA?                    covarLoc   = \"/path/to/covariate/file/\",                     covar_file = \"name_of_covariate_file.tsv\",                     i.files    = c(\"final_report_1\", \"final_report_2\"),  # If you already have chromosome specific genotype files you can pass that directory as a string here                    genoPrefix = \"gm4qtl2\",                     probsOut   = \"muga_interpolated_genoprobs.rds\",      # This is the file that your probabilites will be saved to                    tissues    = c(\"tissue1\", \"tissue2\"))                # All probabilities will be attributed to each tissue, this is just to put it in the format needed for `mapQTL`"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Mapping and Peak Calling","title":null,"text":"mapping peak calling steps combined pipeline. use genoprobs calculate kinship, create genetic pysical maps. using quantified data sample metadata rankZ normalize counts, calculate covariates finally peak calling using qtl2::scan1.","code":"## Unevaluated Code Chunk ## Passing objects: map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = probs,                      samp_meta     = demo_meta,                   # Make sure that your ID column is named \"ID\"                     expr_mats     = list(\"mESC\" = demo_counts),  # Pass your counts as a named list                     covar_factors = c(\"sex\"),                     gridFile      = gridfile,                      annots        = demo_annot,                  # See the Annotations section above for notes on this                     save          = \"ro\")                        # return only - other options are \"so\" (save only) and \"sr\" (save and return)  ## Passing file locations map_peaks <- mapQTL(outdir        = \"../../vignette/\",                      peaks_out     = \"mm39_peaks.rds\",                     map_out       = \"mm39_map.rds\",                      genoprobs     = \"path/to/saved/probs.rds\",                     samp_meta     = \"path/to/sample/metadata\",                     expr_mats     = c(\"path/to/counts1\",\"path/to/coounts/2\"),                      covar_factors = c(\"sex\"),                     gridFile      = \"path/to/custom/grid\",                     annots        = \"path/to/annotations\",                     save          = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Mediation","title":null,"text":"mediation use peaks, mapping information (includes rankZ normalized counts), annotations identify targets turn allows us identify phenotypes act mediators peaks suggestive LOD. done using intermediate::mediation.scan.","code":"## Unevaluated Code Chunk med_res <- run_mediate(peaks   = map_peaks$peaks_list,                         mapping = map_peaks$maps_list,                        outdir  = \"../../vignette\",                         annots  = demo_annot,                        suggLOD = 7,                         med_out = \"mm39_mediation.rds\",                         save    = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Effects","title":null,"text":"identify founder effects peaks interest, use peaks, mapping information along suggestive LOD threshold ensure reported effects relevant peaks . done using qtl2::scan1blup.","code":"## Unevaluated Code Chunk effects <- qtl_effects(mapping = map_peaks$maps_list,                         peaks   = map_peaks$peaks_list,                        suggLOD = 7,                         outdir  = \"../../vignette\",                         outfile = \"mm39_effects.rds\",                         save    = \"ro\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/articles/QTLretrievR_ref.html","id":null,"dir":"Articles","previous_headings":"","what":"Submitting to a Job Scheduler","title":null,"text":"Currently, QTLretrievR set identify available cores linux, mac, windows environment. also able identify number cores submitting job SLURM scheduler. Just make sure include following lines SBATCH: number cores calculated parallelization purposes, total number cores identified N*X. don’t include , submitting SLURM scheduler, may identify correct number cores. using scheduler, make sure specify total number cpus whole job. applicable number processes 1.","code":"#SBATCH --ntasks=N #SBATCH --cpus-per-task=X"},{"path":"https://deweyhannah.github.io/QTLretrievR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hannah B. Dewey. Author, maintainer. Selcan Aydin. Author. Daniel Skelly. Contributor. Daniel Gatti. Contributor. Samuel Widmayer. Contributor.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Broman KW, Gatti DM, Simecek P, Furlotte NA, Prins P, Sen S, Yandell BS, Churchill GA (2019). “R/qtl2: Software Mapping Quantitative Trait Loci High-Dimensional Data Multiparent Populations.” Genetics, 211(2), 495-502. doi:10.1534/genetics.118.301595. Chick JM, Munger SC, Simcecek P, Huttlin EL, Choi K, Gatti DM, Raghupathy N, Svenson KL, Churchill GA, Gygi SP (2016). “Defining consequences genetic variation proteome-wide scale.” Nature, 534(7608), 500-505. doi:10.1038/nature18270. Skelly DA, Czechanski , Byers C, Aydin S, Olivier C, Choi K, Gatti DM, Raghupathy N, Keele GR, Stanton , Vincent M, Dion S, Greenstein , Pankratz M, Porter DK, Martin W, O'Connor C, Qin W, Harrill AH, Choi T, Churchill GA, Munger SC, Baker CL, Reinholdt LG (2020). “Mapping Effects Genetic Variation Chromatin State Gene Expression Reveals Loci Control Ground State Pluripotency.” Cell Stem Cell, 27(3), 459-469.e8. doi:10.1016/j.stem.2020.07.005.","code":"@Article{,   title = {R/qtl2: Software for Mapping Quantitative Trait Loci with High-Dimensional Data and Multiparent Populations},   author = {Karl W Broman and Daniel M Gatti and Petr Simecek and Nicholas A Furlotte and Pjotr Prins and Saunak Sen and Brian S Yandell and Gary A Churchill},   journal = {Genetics},   year = {2019},   volume = {211},   number = {2},   pages = {495-502},   doi = {10.1534/genetics.118.301595}, } @Article{,   title = {Defining the consequences of genetic variation on a proteome-wide scale},   author = {Joel M Chick and Steven C Munger and Petr Simcecek and Edward L Huttlin and Kwangbom Choi and Daniel M Gatti and Narayanan Raghupathy and Karen L Svenson and Gary A Churchill and Steven P Gygi},   journal = {Nature},   year = {2016},   volume = {534},   number = {7608},   pages = {500-505},   doi = {10.1038/nature18270}, } @Article{,   title = {Mapping the Effects of Genetic Variation on Chromatin State and Gene Expression Reveals Loci That Control Ground State Pluripotency},   author = {Daniel A Skelly and Anne Czechanski and Candice Byers and Selcan Aydin and Chris Olivier and Kwangbom Choi and Daniel M Gatti and Narayanan Raghupathy and Gregory R Keele and Alexander Stanton and Matthew Vincent and Stephanie Dion and Ian Greenstein and Matthew Pankratz and Devin K Porter and Whitney Martin and Callan O'Connor and Wenning Qin and Alison H Harrill and Ted Choi and Gary A Churchill and Steven C Munger and Christopher L Baker and Laura G Reinholdt},   journal = {Cell Stem Cell},   year = {2020},   volume = {27},   number = {3},   pages = {459-469.e8},   doi = {10.1016/j.stem.2020.07.005}, }"},{"path":"https://deweyhannah.github.io/QTLretrievR/index.html","id":null,"dir":"","previous_headings":"","what":"Installation","title":null,"text":"Install QTLretrievR GitHub","code":"devtools::install_github(\"deweyhannah/QTLretrievR\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/index.html","id":null,"dir":"","previous_headings":"","what":"Documentation","title":null,"text":"see examples use QTLretrievR, please see “Articles” tab .","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/LOD_thld.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine significant and suggestive LOD thresholds — LOD_thld","title":"Determine significant and suggestive LOD thresholds — LOD_thld","text":"Determine significant suggestive LOD thresholds QTLs, using scan1perm qtl2. Select number genes permute, number permutations, number genes run batch.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/LOD_thld.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine significant and suggestive LOD thresholds — LOD_thld","text":"","code":"LOD_thld(   mapping,   tissue,   annots = NULL,   n.gene = 75,   n.perm = 750,   batch.size = 5 )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/LOD_thld.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine significant and suggestive LOD thresholds — LOD_thld","text":"mapping Mapping list mapQTL, full path .rds containing one. tissue Tissue determine thresholds . annots Data frame phenotype annotations filtering autosomal phenotypes. Columns must include \"id\", \"symbol\", \"start\", \"end\". n.gene Number phenotypes run permutations . Default 75. n.perm Number permutations run per phenotype.  Default 750. batch.size Number genes parallelized batch.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/LOD_thld.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine significant and suggestive LOD thresholds — LOD_thld","text":"list containing: perms scan1perm object permutations selected genes. thresholds list two elements: significant Median LOD threshold alpha = 0.05. suggestive Median LOD threshold alpha = 0.4.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/QTLretrievR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"QTLretrievR: Calculate the Map, Peaks, Mediation, and Effects for Quantitative Trait Loci — QTLretrievR-package","title":"QTLretrievR: Calculate the Map, Peaks, Mediation, and Effects for Quantitative Trait Loci — QTLretrievR-package","text":"integration 'qtl2' 'intermediate' map genotypes probes (genoprobs), calculate Quantitative Trait Loci (QTL) peaks, identify mediators peaks, identify phenotypic effects within experimental data diversity outbred () mice.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/QTLretrievR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"QTLretrievR: Calculate the Map, Peaks, Mediation, and Effects for Quantitative Trait Loci — QTLretrievR-package","text":"Maintainer: Hannah B. Dewey hannah.dewey@jax.org (ORCID) Authors: Selcan Aydin selcan.aydin@jax.org (ORCID) contributors: Daniel Skelly dan.skelly@jax.org (ORCID) [contributor] Daniel Gatti dan.gatti@jax.org (ORCID) [contributor] Samuel Widmayer samuel.widmayer@jax.org (ORCID) [contributor]","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annot_105.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotations file — annot_105","title":"Annotations file — annot_105","text":"Ensembl v105 annotations.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annot_105.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotations file — annot_105","text":"","code":"data(annot_105)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annot_105.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Annotations file — annot_105","text":"55416 x 5 data frame gene annotations Ensembl v105. id Ensembl gene IDs symbol Associated MGI symbol chr Chromosome gene start Start position (bp) chromosome end End position (bp) chromosome","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annot_105.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Annotations file — annot_105","text":"ensembl.org","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annotatePeaks.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate peak positions and attach annotations — annotatePeaks","title":"Interpolate peak positions and attach annotations — annotatePeaks","text":"Interpolate peak positions attach annotations","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annotatePeaks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate peak positions and attach annotations — annotatePeaks","text":"","code":"annotatePeaks(mapping, peaks, annots, localRange = 2e+06)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annotatePeaks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate peak positions and attach annotations — annotatePeaks","text":"mapping Mapping list mapQTL. peaks List un-annotated peaks. annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"start\", \"end\". localRange Definition \"local\" bp. Default 2e6.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/annotatePeaks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate peak positions and attach annotations — annotatePeaks","text":"List annotated peaks tissue.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/check_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Checking the inputted data for QTLretrievR — check_data","title":"Checking the inputted data for QTLretrievR — check_data","text":"Checking inputted data QTLretrievR","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/check_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Checking the inputted data for QTLretrievR — check_data","text":"","code":"check_data(x, type = \"\")"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/check_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Checking the inputted data for QTLretrievR — check_data","text":"x can path Rds object list R objects. type name object single one passed. Use \"genoprobs\" genotype probabilities, \"mediation\" mediation results \"peaks\" table eQTL peaks.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/check_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Checking the inputted data for QTLretrievR — check_data","text":"List properly names R objects used downstream analysis QTLretrievR.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_annot.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo Annotations — demo_annot","title":"Demo Annotations — demo_annot","text":"Ensembl v84 annotations used vignette.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_annot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo Annotations — demo_annot","text":"","code":"data(demo_annot)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_annot.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo Annotations — demo_annot","text":"46521 x 6 data frame gene annotations Ensembl v84. id Ensembl gene IDs symbol Associated MGI symbol chr Chromosome gene start Start position (bp) chromosome end End position (bp) chromosome strand strand gene ","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_annot.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Demo Annotations — demo_annot","text":"Skelly et al., Mapping Effects Genetic Variation Chromatin State Gene Expression Reveals Loci Control Ground State Pluripotency, Cell Stem Cell (2020), https://doi.org/10.1016/j.stem.2020.07.005","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo Counts — demo_counts","title":"Demo Counts — demo_counts","text":"Downsampled mESC gene expression counts used vignette.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo Counts — demo_counts","text":"","code":"data(demo_counts)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_counts.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo Counts — demo_counts","text":"1000 x 10 matrix normalized gene expression column different sample genes rows. rows Gene names Ensembl IDs cols Individual sample IDs","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_counts.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Demo Counts — demo_counts","text":"Skelly et al., Mapping Effects Genetic Variation Chromatin State Gene Expression Reveals Loci Control Ground State Pluripotency, Cell Stem Cell (2020), https://doi.org/10.1016/j.stem.2020.07.005","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo Metadata — demo_meta","title":"Demo Metadata — demo_meta","text":"Sample metadata used vignette.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo Metadata — demo_meta","text":"","code":"data(demo_annot)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_meta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo Metadata — demo_meta","text":"243 x 2 data frame metadata information sample. ID Sample IDs sex sex sample origin","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_meta.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Demo Metadata — demo_meta","text":"Skelly et al., Mapping Effects Genetic Variation Chromatin State Gene Expression Reveals Loci Control Ground State Pluripotency, Cell Stem Cell (2020), https://doi.org/10.1016/j.stem.2020.07.005","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo Probabilities — demo_probs","title":"Demo Probabilities — demo_probs","text":"Sample genotype probabilities used vignette.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo Probabilities — demo_probs","text":"","code":"data(demo_probs)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_probs.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo Probabilities — demo_probs","text":"list genoprobs sample/marker separated chromosome Outer List Chromosome Inner List 3D dataset samples x haplotype x marker","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/demo_probs.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Demo Probabilities — demo_probs","text":"Skelly et al., Mapping Effects Genetic Variation Chromatin State Gene Expression Reveals Loci Control Ground State Pluripotency, Cell Stem Cell (2020), https://doi.org/10.1016/j.stem.2020.07.005","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/genoprobably.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert GBRS tsv genome probabilities to genoprobs format. — genoprobably","title":"Convert GBRS tsv genome probabilities to genoprobs format. — genoprobably","text":"Converts GBRS-formatted TSV genotype probability files 3D array format compatible qtl2, organized tissue sample, optionally saves result RDS file","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/genoprobably.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert GBRS tsv genome probabilities to genoprobs format. — genoprobably","text":"","code":"genoprobably(   outfile = \"./gbrs_interpolated_genoprobs.rds\",   gbrsFileLoc,   tissues = c(),   gridFile = gridfile,   save = \"sr\" )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/genoprobably.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert GBRS tsv genome probabilities to genoprobs format. — genoprobably","text":"outfile File path save resulting genopbrobs list. Defaults \"gbrs_interpolated_genoprobs.rds\". gbrsFileLoc File path GBRS files located. tissues Character vector tissue names. match substrings GBRS file names. empty, defaults fo \"\". gridFile Either data frame file path genome grid used assign marker names. Default 75K grid loaded package. save Character. Determines output behavior: \"sr\" save return, \"\" save , \"ro\" return . Default \"sr\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/genoprobably.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert GBRS tsv genome probabilities to genoprobs format. — genoprobably","text":"named list 3D genotype probability arrays (one per tissue), formatted use qtl2.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile","title":"Grid Map — gridfile","text":"75k genetic physical map mm39 genome assembly.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile","text":"","code":"data(gridfile)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile","text":"74165 x 4 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile","text":"Updated GBRS software, see \"https://github.com/TheJacksonLaboratory/cs-nf-pipelines/wiki/GBRS-Pipeline-ReadMe\" details.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile69k.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile69k","title":"Grid Map — gridfile69k","text":"69k genetic physical map mm39 genome assembly.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile69k.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile69k","text":"","code":"data(gridfile69k)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile69k.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile69k","text":"69005 x 4 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile69k.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile69k","text":"Updated GBRS software, see \"https://github.com/TheJacksonLaboratory/cs-nf-pipelines/wiki/GBRS-Pipeline-ReadMe\" details.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_GM.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile_GM","title":"Grid Map — gridfile_GM","text":"GigaMUGA genetic physical maps mm39 genome assembly.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_GM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile_GM","text":"","code":"data(gridfile_GM)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_GM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile_GM","text":"143259 x 3 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_GM.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile_GM","text":"https://raw.githubusercontent.com/kbroman/MUGAarrays/main/UWisc/gm_uwisc_v4.csv.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_MM.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile_MM","title":"Grid Map — gridfile_MM","text":"MegaMUGA genetic physical map mm39 genome assembly.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_MM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile_MM","text":"","code":"data(gridfile_MM)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_MM.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile_MM","text":"77808 x 3 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_MM.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile_MM","text":"https://raw.githubusercontent.com/kbroman/MUGAarrays/refs/heads/main/UWisc/mm_uwisc_v4.csv.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_mini.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile_mini","title":"Grid Map — gridfile_mini","text":"miniMUGA genetic physical map mm39 genome assembly.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_mini.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile_mini","text":"","code":"data(gridfile_mini)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_mini.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile_mini","text":"11125 x 3 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_mini.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile_mini","text":"https://raw.githubusercontent.com/kbroman/MUGAarrays/refs/heads/main/UWisc/mini_uwisc_v5.csv.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_quilt.html","id":null,"dir":"Reference","previous_headings":"","what":"Grid Map — gridfile_quilt","title":"Grid Map — gridfile_quilt","text":"Genetic Physical Maps used genotypes Genotyping lcWGS.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_quilt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Grid Map — gridfile_quilt","text":"","code":"data(gridfile_quilt)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_quilt.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Grid Map — gridfile_quilt","text":"999999 x 3 data frame marker names included row names: chr Chromosome name pos Marker position basepairs cM Marker position centiMorgan","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gridfile_quilt.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Grid Map — gridfile_quilt","text":"See https://www.biorxiv.org/content/10.1101/2025.05.19.654056v1 information Genotyping lcWGS.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gxeQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate mapping data and peaks for G x E QTL analysis — gxeQTL","title":"Generate mapping data and peaks for G x E QTL analysis — gxeQTL","text":"function performs G x E QTL mapping across multiple tissues, generating genome-wide LOD scores identifying significant peaks. supports parallel processing flexible input formats expression data covariates.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gxeQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate mapping data and peaks for G x E QTL analysis — gxeQTL","text":"","code":"gxeQTL(   genoprobs,   samp_meta,   expr_mats,   covar_factors,   thrA = 5,   thrX = 5,   gridFile = gridfile,   localRange = 2e+06,   outdir = NULL,   peaks_out = \"gxe_peaks.rds\",   map_out = \"gxe_map.rds\",   annots = NULL,   total_cores = NULL,   save = \"sr\",   delta = FALSE,   ctrl,   env,   rz = FALSE,   ... )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gxeQTL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate mapping data and peaks for G x E QTL analysis — gxeQTL","text":"genoprobs Genotype probabilities object (qtl2-formatted), path .rds file containing one. samp_meta Sample metadata. Either string pointing file, object . expr_mats List normalized count matrices (objects), character paths file. One matrix per tissue. order must match tissue order genoprobs. covar_factors Additive covariate factors. need columns factor metadata. thrA Minimum reported LOD threshold autosomes. Default 5. thrX Minimum reported LOD threshold X chromosome. Default 5. gridFile Genome Grid. Path location object. Defaults 75k grid loaded package. localRange Definition \"local\" bp. Default 2e6. outdir Directory save output files. Default NULL. peaks_out String indicating name output peaks file. file saved .rds format used input downstream analysis. end  .rds. Default \"gxe_peaks.rds\" map_out String indicating name output file containing G x E QTL mapping results. file saved .rds format used downstream analyses. end .rds. Default \"gxe_map.rds\" annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"start\", \"end\". total_cores Number available cores use parallelization. Default NULL. save Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\". delta Logical. delta method G x E analysis (env - ctrl) used. Default FALSE. ctrl String indicating control background gene name (ex: \"ctrl\" \"CTRL\"). env String indicating exposed/treated samples (ex: \"trt\" \"treated\" \"<your_treatment_here>\"). rz Logical. Set TRUE expression data already rankZ-transformed. Default FALSE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/gxeQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate mapping data and peaks for G x E QTL analysis — gxeQTL","text":"list containing: maps_listA list dataframes lists can used future analyses functions qtlprobsGenome probabilities qtl2format covar_listlist covariate matrices tissue expr_listOriginal normalized expression data tissue exprZ_listRank Z normalized expression data tissue kinship_locoKisnhip Matrix calculated using \"loco\" option qtl2::calc_kinship gmapGenomic map markers map_dat2Combined genomic physical map markers pmapPhysical map markers tissue_sampMetadata broken tissue peaks_listA list peaks list tissue.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsHapEffects.html","id":null,"dir":"Reference","previous_headings":"","what":"Map founder haplotype effects for a given hotspot. — hsHapEffects","title":"Map founder haplotype effects for a given hotspot. — hsHapEffects","text":"Map founder haplotype effects given hotspot.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsHapEffects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map founder haplotype effects for a given hotspot. — hsHapEffects","text":"","code":"hsHapEffects(   effects,   tbands,   chromosome,   tissue,   sigLOD,   hsNum = 1,   pop = \"do\",   founders = NULL,   palette = NULL,   topFeats = NULL,   psave = TRUE,   pname = NULL,   outdir = NULL,   vert = FALSE,   showTarg = TRUE,   ... )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsHapEffects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map founder haplotype effects for a given hotspot. — hsHapEffects","text":"effects Effects object qtl_effects. tbands List transband locations (bands.rna list transbands function) chromosome Chromosome transband (hotspot) present . tissue Tissue transband (hotspot) present sigLOD Significant LOD threshold use filtering phenotypes. hsNum multiple hotspots chromosome, indicate one. Default 1. pop One c(\"\", \"cc\", \"\") indicate founder population. Default \"\". founders pop == \"\", list founders haplotype order. palette Founder color map. topFeats Optional. Top hotspot features based PCA analysis. psave Logical. Save plot .png. Default TRUE. pname File name save plot (needs end .png). Default haplotype_effects_<tissue>_transband_<hsNum>_chromosome_<chromosome>.png outdir Directory save plots. Default NULL. vert Logical. Rotate plot vertical orientation. Default FALSE. showTarg Logical. Show target names resulting plot. Default TRUE. ... Additional arguments pass ComplexHeatmap","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsHapEffects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map founder haplotype effects for a given hotspot. — hsHapEffects","text":"List plots. ht_plot: Plot , formatted legend left. ht: Original ComplexHeatmap object.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsPeakPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an individual peak or Principal Component of a hotspot. — hsPeakPlot","title":"Plot an individual peak or Principal Component of a hotspot. — hsPeakPlot","text":"Plot individual peak Principal Component hotspot.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsPeakPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an individual peak or Principal Component of a hotspot. — hsPeakPlot","text":"","code":"hsPeakPlot(   mapping,   feats,   tbands,   chromosome,   tissue,   candidateMed = NULL,   hsNum = 1,   color = \"#0073C2FF\",   pc = FALSE,   wag = FALSE,   sigLOD,   topPC = 0.5,   psave = TRUE,   pname = NULL,   outdir = NULL,   ... )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsPeakPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an individual peak or Principal Component of a hotspot. — hsPeakPlot","text":"mapping Mapping list mapQTL. feats List phenotypes include. Individual/Candidate Mediator : Local hotspot. PC: Targets hotspot. tbands List transband locations (bands.rna list transbands function). chromosome Chromosome transband (hotspot) present . tissue Tissue transband (hotspot) present . candidateMed Dataframe candidate mediator information (can annotations). Columns must include \"id\", \"symbol\", \"start\", \"end\". hsNum multiple hotspots chromosome, indicate one. Default 1. color Plot color. Default \"#0073C2FF\". pc Logical. Plot first principal component targets. Default FALSE. wag Logical. Include tailWag effects plot final. Default FALSE. sigLOD Significant LOD threshold use filtering phenotypes. topPC Proportion top hotspot contributers identified Principal Component Analysis. Default 0.5. psave Logical. Save plot .png. Default TRUE. pname File name save plot (needs end .png). outdir Directory save plots. Default NULL. ... Additional arguments","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/hsPeakPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot an individual peak or Principal Component of a hotspot. — hsPeakPlot","text":"ggplot/patchwork object: Peak plot (without phenotype effects). plotting Principal Component hotspot, also includes list top proportion phenotypes contributing hotspot.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_bp.html","id":null,"dir":"Reference","previous_headings":"","what":"interp_bp — interp_bp","title":"interp_bp — interp_bp","text":"Interpolate bp peak positions bp based marker maps","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_bp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"interp_bp — interp_bp","text":"","code":"interp_bp(df, genmap, physmap)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_bp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"interp_bp — interp_bp","text":"df peak dataframe peak position cM. genmap Genetic map - found maps_list (gmap). physmap Physical map - found maps_list (pmap).","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_bp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"interp_bp — interp_bp","text":"Peak dataframe interpolated bp column appended","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_cM.html","id":null,"dir":"Reference","previous_headings":"","what":"interp_cM — interp_cM","title":"interp_cM — interp_cM","text":"Interpolate bp peak positions cM based marker maps.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_cM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"interp_cM — interp_cM","text":"","code":"interp_cM(df, genmap, physmap)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_cM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"interp_cM — interp_cM","text":"df peak dataframe peak position bp. genmap Genetic map - found maps_list (gmap). physmap Physical map - found maps_list (pmap).","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/interp_cM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"interp_cM — interp_cM","text":"Peak dataframe interpolated bp column appended","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mapQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate mapping data and peaks for QTL analysis — mapQTL","title":"Generate mapping data and peaks for QTL analysis — mapQTL","text":"function performs QTL mapping across multiple tissues, generating genome-wide LOD scores identifying significant peaks. supports parallel processing flexible input formats expression data covariates.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mapQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate mapping data and peaks for QTL analysis — mapQTL","text":"","code":"mapQTL(   genoprobs,   samp_meta,   expr_mats,   covar_factors,   thrA = 5,   thrX = 5,   gridFile = gridfile,   localRange = 2e+06,   outdir = NULL,   peaks_out = \"peaks.rds\",   map_out = \"map.rds\",   annots = NULL,   total_cores = NULL,   save = \"sr\",   rz = FALSE,   phys = TRUE,   ... )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mapQTL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate mapping data and peaks for QTL analysis — mapQTL","text":"genoprobs Genotype probabilities object (qtl2-formatted), path .rds file containing one. samp_meta Sample metadata. Either string pointing file, object . expr_mats List normalized count matrices (objects), character paths file. One matrix per tissue. order must match tissue order genoprobs. NOTE using rz = TRUE phenotypes columns expression matrices. covar_factors Additive covariate factors. need columns factor metadata. thrA Minimum reported LOD threshold autosomes. Default 5. thrX Minimum reported LOD threshold X chromosome. Default 5. gridFile Genome Grid. Path location object. Defaults 75k grid loaded package. localRange Definition \"local\" bp. Default 2e6. outdir Directory save output files. Default NULL. peaks_out String indicating name output peaks file. file saved .rds format used input downstream analysis. end  .rds. Default \"gxe_peaks.rds\" map_out String indicating name output file containing QTL mapping results. file saved .rds format used downstream analyses. end .rds. Default \"map.rds\" annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"chr\", \"start\", \"end\". total_cores Number available cores use parallelization. Default NULL. save Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\". rz Logical. Set TRUE expression data already rankZ-transformed. Default FALSE. phys Logical. TRUE, use physical map peak calling; otherwise use genomic map. Default TRUE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mapQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate mapping data and peaks for QTL analysis — mapQTL","text":"list containing: maps_listA list dataframes lists can used future analyses functions qtlprobsGenome probabilities qtl2format covar_listlist covariate matrices tissue expr_listOriginal normalized expression data tissue exprZ_listRank Z-transformed expression data tissue kinship_locoKinship matrix calculated using \"loco\" option qtl2::calc_kinship gmapGenomic map markers map_dat2Combined genomic physical map markers pmapPhysical map markers tissue_sampMetadata broken tissue peaks_listA list peaks list tissue.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_hotSpot.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify top mediators within a hotspot (molecular QTL) — medPlot_hotSpot","title":"Identify top mediators within a hotspot (molecular QTL) — medPlot_hotSpot","text":"Identify top mediators within hotspot (molecular QTL)","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_hotSpot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify top mediators within a hotspot (molecular QTL) — medPlot_hotSpot","text":"","code":"medPlot_hotSpot(   peaks,   meds,   tbands,   chromosome,   sigLOD,   hsNum = 1,   top_n = 5,   plot = \"padj\",   topFeats = NULL,   psave = TRUE,   pname = NULL,   outdir = NULL,   showTarg = T )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_hotSpot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify top mediators within a hotspot (molecular QTL) — medPlot_hotSpot","text":"peaks Dataframe peaks pull targets (output mapQTL, select peaks_list$tissue). meds Dataframe mediation pull potential mediators (output modiFinder, select $tissue). tbands Dataframe transbands (output transbands, select bands.rna$tissue). chromosome Chromosome transband (hotspot) present . sigLOD Significant LOD threshold use filtering phenotypes. hsNum multiple hotspots chromosome, indicate one. Default 1. top_n number top mediators per target show, determined LOD drop. Default 5. NB want see mediators, set number mediators hotspot. plot One c(\"padj\", \"pval\", \"per_drop\", \"ranks\") depending statistic plotted heatmap. Default \"padj\". topFeats Optional. Top hotspot features based PC analysis. psave Logical. Save plot .png. Default TRUE. pname String indicating name plot save .png. Default \"mediation_plot_chrtop<top_n>.png\". outdir Directory save plots. Default NULL. showTarg Logical. Show target names resulting plot. Default TRUE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_hotSpot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify top mediators within a hotspot (molecular QTL) — medPlot_hotSpot","text":"list containing dataframe representing ranking mediator within hotspot target hotspot heatmap object.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify mediators for provided features +/- x Mb from a given position on a given chromosome — medPlot_single","title":"Identify mediators for provided features +/- x Mb from a given position on a given chromosome — medPlot_single","text":"Identify mediators provided features +/- x Mb given position given chromosome","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify mediators for provided features +/- x Mb from a given position on a given chromosome — medPlot_single","text":"","code":"medPlot_single(   meds,   range = 2,   position,   feats,   chromosome,   top_n = 5,   psave = TRUE,   pname = NULL,   outdir = NULL,   plot = \"padj\",   showTarg = TRUE )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_single.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify mediators for provided features +/- x Mb from a given position on a given chromosome — medPlot_single","text":"meds Dataframe mediation pull potential mediators (output modiFinder, select $tissue). range range position mediatiors pulled. Mbp. position position peak(s) investigated (single position ). bp. feats Vector targets identify mediators . chromosome Chromosome peaks(s) present . top_n number top mediators per target show. Default 5. psave Logical. Save plot .png. Default TRUE. pname String indicating name plot save .png. Default \"mediation_plot_chrtop<top_n>.png\". outdir Directory save plots. Default NULL. plot One c(\"padj\", \"pval\", \"per_drop\", \"ranks\") depending statistic plotted heatmap. Default \"padj\". showTarg Logical. Show target names resulting plot. Default TRUE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/medPlot_single.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify mediators for provided features +/- x Mb from a given position on a given chromosome — medPlot_single","text":"list containing dataframe representing ranking mediator within region provided targets heatmap object.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/modiFinder.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare and run mediation for a set of QTL peaks — modiFinder","title":"Prepare and run mediation for a set of QTL peaks — modiFinder","text":"Prepare run mediation set QTL peaks","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/modiFinder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare and run mediation for a set of QTL peaks — modiFinder","text":"","code":"modiFinder(   peaks,   mapping,   sigLOD = 7.5,   annots,   outdir = NULL,   med_out = \"mediation.rds\",   total_cores = NULL,   save = \"sr\",   distOnly = TRUE,   hsOnly = FALSE )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/modiFinder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare and run mediation for a set of QTL peaks — modiFinder","text":"peaks List dataframes containing QTL peaks tissue, full path .rds containing one. mapping Mapping list mapQTL, full path .rds containing one. sigLOD Significant LOD threshold use filter phenotypes mediation. Default 7.5 annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"start\", \"end\". outdir Directory save output files. Default NULL. med_out String indicating name output file containing mediation results mediation within phenotype. file saved .rds format used downstream analysis visualization. end .rds. Default \"mediation.rds\" total_cores Number available cores use parallelization. Default NULL. save Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\". distOnly Logical. Mediate distal peaks? Default TRUE. hsOnly Logical. Mediate peaks identified within hotspot. Default FALSE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/modiFinder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare and run mediation for a set of QTL peaks — modiFinder","text":"list containing mediation results tissue","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mugaprobs.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert and process MUGA probabilities to qtl2 format — mugaprobs","title":"Convert and process MUGA probabilities to qtl2 format — mugaprobs","text":"Converts MUGA genotyping final reports 3D array format compatible qtl2, organized tissue sample, optionally saves result RDS file","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mugaprobs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert and process MUGA probabilities to qtl2 format — mugaprobs","text":"","code":"mugaprobs(   type = \"GM\",   covarLoc,   covar_file,   i.files,   genoPrefix = \"gm4qtl2\",   probsOut = \"muga_interpolated_genoprobs.rds\",   saveDir = getwd(),   tissues = c() )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mugaprobs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert and process MUGA probabilities to qtl2 format — mugaprobs","text":"type One c(\"GM\", \"MM\"); GigaMUGA MegaMUGA. Default \"GM\". covarLoc Location covariate file. covar_file Covariate file including minimum sex (sex) generation (ngen) sample, needs .csv file .files Either string directory chromosome specific genotype files list final report files process - passing final report files need either unzipped .gz format genoPrefix Prefix chromosome specific genotype files (excluding \"_geno\") probsOut File name save probabilities, default \"muga_interpolated_genoprobs.rds\". saveDir Directory save genome probability object. Default current working directory. tissues List tissues included analysis. left blank tissue set \"\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/mugaprobs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert and process MUGA probabilities to qtl2 format — mugaprobs","text":"none","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/multi_modiFinder.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare and run between phenotype mediation for a set of QTL peaks with provided expression data. — multi_modiFinder","title":"Prepare and run between phenotype mediation for a set of QTL peaks with provided expression data. — multi_modiFinder","text":"Mediation scan two different phenotypes. Provide peaks mapping phenotype mediate, rank Z-transformed phenotype quantification use mediators.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/multi_modiFinder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare and run between phenotype mediation for a set of QTL peaks with provided expression data. — multi_modiFinder","text":"","code":"multi_modiFinder(   peaks,   mapping,   exprZ,   suggLOD = 7,   annots,   outdir = NULL,   med_out = \"multi_pheno_mediation.rds\",   total_cores = NULL,   save = \"sr\" )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/multi_modiFinder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare and run between phenotype mediation for a set of QTL peaks with provided expression data. — multi_modiFinder","text":"peaks List dataframes containing QTL peaks tissue, full path pointing saved peaks object. mapping Mapping list mapQTL, full path .rds containing one. exprZ rankZ transformed expression use mediation. suggLOD Significant LOD threshold use filter phenotypes mediation. Default 7.5 annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"start\", \"end\". outdir Directory save output files. Default NULL. med_out String indicating name output file containing mediation results mediation phenotypes. file saved .rds format used downstream analysis visualization. end .rds. Default \"multi_pheno_mediation.rds\" total_cores Number available cores use parallelization. Default NULL. save Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/multi_modiFinder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare and run between phenotype mediation for a set of QTL peaks with provided expression data. — multi_modiFinder","text":"list containing mediation results tissue","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/peak_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot peaks associated with specific genes. — peak_plot","title":"Plot peaks associated with specific genes. — peak_plot","text":"Plot peaks associated specific genes.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/peak_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot peaks associated with specific genes. — peak_plot","text":"","code":"peak_plot(   mapping,   tissue,   pheno,   pop = \"do\",   outdir = NULL,   pname = NULL,   psave = TRUE,   chromosome = NULL,   effects = FALSE,   founders = NULL,   palette = NULL )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/peak_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot peaks associated with specific genes. — peak_plot","text":"mapping Mapping list mapQTL, full path .rds containing one. tissue Tissue derive plots pheno Phenotype plot pop One c(\"\", \"cc\", \"\") indicate founder population. Default \"\". outdir Directory save plots. Default NULL. pname File name save plot (needs end .png). psave Logical. Save plot .png. Default TRUE. chromosome Chromosome peaks present . effects Logical. Plotting effects chromosome. Default FALSE. founders pop == \"\", list founders haplotype order. palette Founder color map (> 8 founders).","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/peak_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot peaks associated with specific genes. — peak_plot","text":"Plot phenotype specific peaks, phenotype specific peak effects","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/plot_eqtlmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot QTL maps (peak vs gene) — plot_eqtlmap","title":"Plot QTL maps (peak vs gene) — plot_eqtlmap","text":"Plot QTL maps (peak vs gene)","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/plot_eqtlmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot QTL maps (peak vs gene) — plot_eqtlmap","text":"","code":"plot_eqtlmap(   map_dat,   peaks,   sigLOD = 7.5,   outdir = NULL,   pname = NULL,   psave = TRUE,   unit = \"bp\",   map_col = \"#0073C2FF\" )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/plot_eqtlmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot QTL maps (peak vs gene) — plot_eqtlmap","text":"map_dat map_dat2 mapQTL mapping list. peaks List dataframes containing QTL peaks tissue (annotated). sigLOD Significant LOD threshold use filtering phenotypes. Default 7.5 outdir Directory save plots. Default NULL. pname File name save plot (needs end .png). Default \"eqtl_map_LOD_.png\". psave Logical. Save plot .png. Default TRUE. unit One c(\"bp\", \"mbp\"); annotation position units. Default \"bp\". map_col Plot color. Default \"#0073C2FF\"","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/plot_eqtlmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot QTL maps (peak vs gene) — plot_eqtlmap","text":"list peak maps (ggplot objects) tissue","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/qtl_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate founder effects for significant peaks — qtl_effects","title":"Calculate founder effects for significant peaks — qtl_effects","text":"Calculate founder effects significant peaks","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/qtl_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate founder effects for significant peaks — qtl_effects","text":"","code":"qtl_effects(   peaks,   mapping,   suggLOD = 6,   outdir = NULL,   effects_out = \"effects.rds\",   total_cores = NULL,   save = \"sr\" )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/qtl_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate founder effects for significant peaks — qtl_effects","text":"peaks List dataframes containing annotated QTL peaks tissue, full path .rds containing one. mapping Mapping list mapQTL, full path .rds containing one. suggLOD Suggestive LOD threshold use filtering phenotypes. Default 6. outdir Directory save effects output files. Default NULL. effects_out String indicating name output file containing founder haplotype effects results. file saved .rds format used downstream analysis visualization. end .rds. Default \"effects.rds\" total_cores Number available cores use parallelization. Default NULL. save Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/qtl_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate founder effects for significant peaks — qtl_effects","text":"list containing: effects_blupQTL effect BLUPs scan along one chromosome. Output qtl2::scan1blup() peaksannotated peaks LOD scores suggestive threshold","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/runQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function to generate mapping, peaks, mediation, and effects data — runQTL","title":"Wrapper function to generate mapping, peaks, mediation, and effects data — runQTL","text":"Wrapper function generate mapping, peaks, mediation, effects data","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/runQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function to generate mapping, peaks, mediation, and effects data — runQTL","text":"","code":"runQTL(   geno_out = \"gbrs_interpolated_genoprobs.rds\",   peaks_out = \"peaks.rds\",   map_out = \"mapping.rds\",   med_out = \"mediation_res.rds\",   effects_out = \"effects.rds\",   outdir = NULL,   gbrs_fileLoc,   metadata,   expr_mats,   covar_factors,   annots,   tissues = c(),   gridFile = gridfile,   total_cores = NULL,   save_t = \"sr\",   ... )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/runQTL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function to generate mapping, peaks, mediation, and effects data — runQTL","text":"geno_out String indicating name output file containing interpolated genotype probabilities. file saved .rds format used QTL mapping. end .rds. Default \"gbrs_interpolated_genoprobs.rds\". peaks_out String indicating name output peaks file. file saved .rds format used input downstream analysis. end  .rds. Default \"peaks.rds\" map_out String indicating name output file containing QTL mapping results. file saved .rds format used downstream analyses. end .rds. Default \"map.rds\" med_out String indicating name output file containing mediation results mediation within phenotype. file saved .rds format used downstream analysis visualization. end .rds. Default \"mediation.rds\" effects_out String indicating name output file containing founder haplotype effects results. file saved .rds format used downstream analysis visualization. end .rds. Default \"effects.rds\" outdir Directory save output files. Default NULL. gbrs_fileLoc Path GBRS interpolated tsv files. metadata Sample metadata. Either string pointing file, object . expr_mats List normalized count matrices (objects), character paths file. One matrix per tissue. order must match tissue order genoprobs. covar_factors Additive covariate factors. need columns sample metadata. annots Annotations file. Contains mapping information phenotypes. Dataframe, tsv. Columns must include \"id\", \"symbol\", \"start\", \"end\". tissues Vector strings indicating tissues conditions project. gridFile Genome Grid. Path location object. Defaults 75k grid loaded package. total_cores Number available cores use parallelization. Default NULL. save_t Indicates object return/save behavior. One c(\"sr\", \"\", \"ro\"); save & return, save , return . Default \"sr\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/runQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function to generate mapping, peaks, mediation, and effects data — runQTL","text":"list containing peaks_listUnfiltered peaks tissue. maps_listList objects associated mapping. See mapQTL help details. res_listList containing mediation results tissue. effects_resList objects associated effects. See qtl_effects help details.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/split_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Background functions for QTLretrievR that will be called by the primary functions — split_map","title":"Background functions for QTLretrievR that will be called by the primary functions — split_map","text":"Background functions QTLretrievR called primary functions","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/split_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Background functions for QTLretrievR that will be called by the primary functions — split_map","text":"","code":"split_map(map, chr_names = NULL)"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/split_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Background functions for QTLretrievR that will be called by the primary functions — split_map","text":"map grid map markers, chromosomes, positions markers chr_names vector chromosome names","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/tailWag.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a plot with founder effects for a given phenotype — tailWag","title":"Create a plot with founder effects for a given phenotype — tailWag","text":"Create plot founder effects given phenotype","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/tailWag.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a plot with founder effects for a given phenotype — tailWag","text":"","code":"tailWag(   effects,   tissue,   feat,   chromosome,   color = \"#0073C2FF\",   psave = TRUE,   pname = NULL,   outdir = NULL,   pop = \"do\",   founders = NULL,   symbol = TRUE )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/tailWag.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a plot with founder effects for a given phenotype — tailWag","text":"effects Effects object (output qtl_effects function). tissue String indicating tissue plot founder effects . feat Individual phenotype plot effects . chromosome Chromosome peak present . color Plot color. Default \"#0073C2FF\". psave Logical. Save plot .png. Default TRUE. pname File name save plot (needs end .png). Default wag_effects_<tissue>_<feat>.png outdir Directory save plots. Default NULL. pop One c(\"\", \"cc\", \"\") indicate founder population. Default \"\". founders pop == \"\", list founders haplotype order. symbol Logical. phenotype plotted passed symbol instead phenotype id. Default TRUE.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/tailWag.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a plot with founder effects for a given phenotype — tailWag","text":"ggplot object effects plot","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/transbands.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify distal hotspots above a suggestive and significant LOD score. — transbands","title":"Identify distal hotspots above a suggestive and significant LOD score. — transbands","text":"Identify distal hotspots suggestive significant LOD score.","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/transbands.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify distal hotspots above a suggestive and significant LOD score. — transbands","text":"","code":"transbands(   map_dat,   peaks,   sigLOD = 7.5,   suggLOD = 6,   psave = TRUE,   pname = NULL,   outdir = NULL,   color = \"#0073C2FF\" )"},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/transbands.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify distal hotspots above a suggestive and significant LOD score. — transbands","text":"map_dat map_dat2 mapQTL mapping list. peaks List dataframes containing QTL peaks tissue (annotated). sigLOD Significant LOD threshold use filtering phenotypes. Default 7.5 suggLOD Suggestive LOD threshold use filtering phenotypes. Default 6. psave Logical. Save plot .png. Default TRUE. pname File name save plot (needs end .png). Default hotspots_<tissue>.png outdir Directory save plots. Default NULL. color Plot color. Default \"#0073C2FF\".","code":""},{"path":"https://deweyhannah.github.io/QTLretrievR/reference/transbands.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify distal hotspots above a suggestive and significant LOD score. — transbands","text":"list containing: bands.rnaA list tibbles containing hotspot information tissue Information includes following hotspot: Chromosome hotspot Start Stop (bp) hotspot number significant peaks within hotspot number suggestive peaks within hotspot","code":""}]
